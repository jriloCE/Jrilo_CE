"use strict";(self.webpackChunkfolder_workbench=self.webpackChunkfolder_workbench||[]).push([[5736],{65736:(e,t,r)=>{r.d(t,{Z:()=>gr});var n=r(40540),i=r.n(n),o=r(59530),a=r.n(o),s=r(58560),c=r(25637),l=r(35736),d=r(82196),u=r(64495),p=r(80605),h=r(26246),g=r(98276),m=r(50297),f=r(60607),v=r(98283),b=r(78476);const y="New Folder";function x(){const e=Be();return[e.preRequestStore.content,e.setPreRequestScript]}function k(){const e=Be();return[e.testScriptStore.content,e.setTests]}var w=r(52322);const j=a().div.withConfig({displayName:"indicator-dot__Dot",componentId:"sc-1ijn2f6-0"})(["display:inline-flex;width:calc(0.5 * var(--spacing-m));height:calc(0.5 * var(--spacing-m));margin-left:var(--spacing-xs);border-radius:calc(0.5 * var(--spacing-m));background-color:var(--base-color-success);&.error{background-color:var(--base-color-error);}"]),S=({isError:e=!1})=>(0,w.jsx)(j,{"aria-label":e?"tab with errors":"tab with active values",className:e?"error":"","data-testid":"tab-indicator-dot"}),C=(0,m.observer)((()=>{const[e]=x(),[t]=k(),r=!!t||!!e;return(0,w.jsxs)(s.Z,{alignItems:"center",children:["Scripts",r&&(0,w.jsx)(S,{})]})})),I="prerequest";var _=r(63622),E=r(20856),P=r(39245);const T=a().div.withConfig({displayName:"script-tile__Indicator",componentId:"sc-e4efpw-0"})(["width:4px;height:4px;position:absolute;right:6px;border-radius:6px;background-color:",";"],(({hasError:e})=>e?"var(--base-color-error)":"var(--content-color-tertiary)")),A=a().div.withConfig({displayName:"script-tile__ScriptItemContainer",componentId:"sc-e4efpw-1"})(["display:flex;flex-direction:row;position:relative;align-items:center;box-sizing:border-box;cursor:pointer;padding:var(--spacing-s) var(--spacing-s) var(--spacing-s) var(--spacing-l);color:var( "," );background-color:var( "," );"],(({isActive:e})=>e?"--content-color-primary":"--content-color-secondary"),(({isActive:e})=>e?"--background-color-tertiary":"--background-color-primary")),L=a()(_.ZP).withConfig({displayName:"script-tile__ScriptLabel",componentId:"sc-e4efpw-2"})(["user-select:none;"]),N=a().div.withConfig({displayName:"script-tile__StyledContainer",componentId:"sc-e4efpw-3"})(["margin:var(--spacing-xs);"]),R=({script:e,setActiveScriptKey:t,activeScriptKey:r})=>(0,w.jsx)(E.ZP,{placement:"bottom-start",maxWidth:240,position:"bottom-start",triggerEvent:"mouseenter",delay:1e3,xOffset:60,trigger:(0,w.jsxs)(A,{onClick:()=>t(e.key),isActive:e.key===r,"data-testid":`request-script-tile-${e.key}`,children:[(0,w.jsx)(s.Z,{grow:1,children:(0,w.jsx)(L,{type:"body-medium",children:e.label})}),e.hasValue&&(0,w.jsx)(T,{hasError:!!e.hasError})]}),children:(0,w.jsxs)(N,{children:[(0,w.jsx)(_.ZP,{children:e.tooltipText}),(0,w.jsx)("br",{}),(0,w.jsx)(P.Link,{to:e.tooltipLearnMoreLink,target:"_blank",children:(0,w.jsx)(_.ZP,{type:"link-default",isExternal:!0,children:"Learn more"})})]})});var Z=r(38053),O=r(49709),D=r.n(O),F=r(3341),z=r(3071);const q=a()(s.Z).withConfig({displayName:"right-scripts-panel__LeftSection",componentId:"sc-1ec0dc9-0"})(["flex:1;"]),M=a().div.withConfig({displayName:"right-scripts-panel__SectionBody",componentId:"sc-1ec0dc9-1"})(["flex:1;overflow:hidden;height:100%;margin-top:var(--spacing-l);margin-right:calc(-1 * var(--spacing-xxl));"]);function W(e){const[t,r]=(0,n.useState)(!0);return(0,w.jsxs)(s.Z,{height:"100%",children:[t&&(0,w.jsxs)(q,{direction:"column",children:[(0,w.jsx)("div",{children:e.header}),(0,w.jsx)(M,{children:e.children})]}),(0,w.jsx)("div",{children:(0,w.jsx)(p.Z,{onClick:()=>r((e=>!e)),type:"tertiary",icon:t?(0,w.jsx)(F.Z,{}):(0,w.jsx)(z.Z,{})})})]})}const $=a().h5.withConfig({displayName:"snippet-layout-components__SnippetTitle",componentId:"sc-m4h292-0"})(["flex:0;margin:var(--spacing-zero);margin-bottom:var(--spacing-xs);font-weight:var(--text-weight-bold);word-break:normal;font-size:var(--text-size-m);line-height:1.4;color:var(--content-color-secondary);"]),V=a().ul.withConfig({displayName:"snippet-layout-components__SnippetList",componentId:"sc-m4h292-1"})(["position:relative;z-index:1;overflow:auto;height:calc(100% - var(--spacing-l));flex:1;margin:var(--spacing-zero);padding:var(--spacing-zero);padding-right:var(--spacing-l);color:var(--content-color-link);box-sizing:border-box;font-family:var(--text-family-default);"]),U=a().li.withConfig({displayName:"snippet-layout-components__SnippetListItem",componentId:"sc-m4h292-2"})(["list-style:none;user-select:none;cursor:pointer;padding:var(--spacing-s) var(--spacing-zero);"]);var B=r(97550),H=r(10099),K=r(56880),J=r(56415),Q=r(52385);const G=a()(s.Z).withConfig({displayName:"package-list__DropDownList",componentId:"sc-12qxey9-0"})(["max-height:200px;overflow-y:auto;scrollbar-width:none;-ms-overflow-style:none;&::-webkit-scrollbar{display:none;}"]),Y=a().div.withConfig({displayName:"package-list__DropDownListItem",componentId:"sc-12qxey9-1"})(["display:flex;align-items:center;padding-right:var(--spacing-xs);border-radius:var(--border-radius-default);&:hover{background:var(--highlight-background-color-primary);cursor:pointer;}",""],(({disabled:e})=>e&&"\n    &:hover {\n      background: var(--background-color-primary);\n      cursor: not-allowed;\n    }\n  ")),X=a().div.withConfig({displayName:"package-list__DropDownEmptyState",componentId:"sc-12qxey9-2"})(["padding:var(--spacing-xs) var(--spacing-m);"]),ee=a()(s.Z).withConfig({displayName:"package-list__IconContainer",componentId:"sc-12qxey9-3"})(["height:28px;width:28px;"]),te=a().div.withConfig({displayName:"package-list__CustomMenuError",componentId:"sc-12qxey9-4"})(["display:flex;padding:var(--spacing-xs) var(--spacing-s);"]),re=a()(s.Z).withConfig({displayName:"package-list__CustomMenuLoader",componentId:"sc-12qxey9-5"})(["height:120px;"]),ne=({packages:e,parsedPackagesId:t,searchTerm:r,isLoadingPackages:n,isError:i,refetch:o,handleAddPackages:a})=>{if(n)return(0,w.jsx)(re,{justifyContent:"center",alignItems:"center",children:(0,w.jsx)(l.Z,{description:"Loading packages"})});if(i)return(0,w.jsx)(te,{children:(0,w.jsxs)(_.ZP,{children:["Error loading packages",(0,w.jsx)("span",{style:{marginLeft:"var(--spacing-xs)"},children:(0,w.jsx)(p.Z,{type:"monochrome-plain",text:"retry.",onClick:o})})]})});if(!e||0===e.length)return(0,w.jsx)(X,{children:(0,w.jsx)(_.ZP,{color:"content-color-tertiary",children:"No packages found."})});const s=(null==e?void 0:e.filter((e=>{var t;return!r||(null==(t=e.name)?void 0:t.toLowerCase().includes(r.toLowerCase()))})))||[],c=[],d=[];for(const e of s)t.includes(e.id)?c.push(e):d.push(e);return 0===c.length&&0===d.length?(0,w.jsx)(X,{children:(0,w.jsx)(_.ZP,{color:"content-color-tertiary",children:"No packages found."})}):(0,w.jsxs)(G,{direction:"column",children:[c.map((({id:e,name:t})=>(0,w.jsxs)(Y,{disabled:!0,"data-testid":"package-select-dropdown-item",children:[(0,w.jsx)(ee,{alignItems:"center",justifyContent:"center",children:(0,w.jsx)(Q.Z,{color:"content-color-tertiary"})}),(0,w.jsx)(_.ZP,{color:"content-color-tertiary",isTruncated:!0,tooltip:t,children:t})]},e))),d.map((({id:e,name:t,globalName:r})=>(0,w.jsxs)(Y,{"data-testid":"package-select-dropdown-item",onClick:()=>{K.AnalyticsService.addEventV2({category:"package_library",action:"use_existing_package",entityType:"package",variantId:"ide"}),a(t,r)},children:[(0,w.jsx)(ee,{alignItems:"center",justifyContent:"center"}),(0,w.jsx)(_.ZP,{isTruncated:!0,tooltip:t,children:t})]},e)))]})},ie=a()(E.ZP).withConfig({displayName:"package-select-dropdown__CustomDropDownWrapper",componentId:"sc-ttjjju-0"})(["width:",";transform:translate(var(--border-width-default));background:var(--background-color-primary);border-radius:var(--border-radius-default);border:solid var(--border-width-default) var(--border-color-strong);.tippy-content{background:var(--background-color-primary);border-radius:var(--border-radius-s);}"],(e=>e.popoverWidth||"120px")),oe=a()(s.Z).withConfig({displayName:"package-select-dropdown__CustomDropDownTrigger",componentId:"sc-ttjjju-1"})(["background:var(--background-color-primary);border:solid var(--border-width-default) var(--content-color-tertiary);border-radius:var(--border-radius-default);padding:var(--spacing-xs) var(--spacing-s);padding-right:0;height:32px;margin-right:1px;margin-left:1px;width:248px;&:focus-within{box-shadow:0 0 0 1px var(--input-border-color-focus);}"]),ae=a().input.withConfig({displayName:"package-select-dropdown__CustomDropDownInput",componentId:"sc-ttjjju-2"})(["width:100%;background:var(--background-color-primary);border:none;color:var(--content-color-primary);&::placeholder{color:var(--content-color-tertiary);}"]),se=a().div.withConfig({displayName:"package-select-dropdown__StyledInputContainer",componentId:"sc-ttjjju-3"})(["display:flex;flex-grow:1;"]),ce=a().div.withConfig({displayName:"package-select-dropdown__StyledIconContainer",componentId:"sc-ttjjju-4"})(["width:var(--size-m);height:var(--size-m);display:flex;align-items:center;justify-content:center;cursor:pointer;"]),le=({parsedPackagesId:e,handleAddPackages:t})=>{const[r,i]=(0,n.useState)(!1),[o,a]=(0,n.useState)(""),{data:s,isLoading:c,isError:l,refetch:d}=(0,Z.usePackagesWithGlobalName)(),u=(0,n.useRef)(null),p=(0,n.useRef)(null),h=(0,n.useRef)(null);return(0,n.useLayoutEffect)((()=>{let e;const t=()=>{if(u.current){const e=u.current.getBoundingClientRect();h.current&&(e.top!==h.current.top||e.left!==h.current.left)&&i(!1),h.current=e}e=requestAnimationFrame(t)};return t(),()=>{cancelAnimationFrame(e)}}),[]),(0,w.jsx)(ie,{isOpen:r,onClickOutside:()=>i(!1),popoverWidth:null!=u&&u.current?`${u.current.offsetWidth}px`:null,trigger:(0,w.jsxs)(oe,{justifyContent:"space-between",alignItems:"center",ref:u,"data-testid":"package-select-dropdown-trigger",children:[(0,w.jsx)(se,{onClick:()=>{K.AnalyticsService.addEventV2({category:"package_library",action:"find_and_use_pkgs",variantId:"ide"}),i(!0)},children:(0,w.jsx)(ae,{value:o,onChange:e=>(e=>{a(e)})(e.target.value),placeholder:"Find & use packages",ref:p})}),(0,w.jsx)(ce,{onClick:()=>{var e;i(!r),null==(e=p.current)||e.focus()},children:(0,w.jsx)(J.Z,{})})]}),children:(0,w.jsx)(ne,{packages:s||[],parsedPackagesId:e,searchTerm:o,isLoadingPackages:c,isError:l,refetch:d,handleAddPackages:t})})},de=({packages:e,handleAddPackages:t})=>{const r=(0,H.useActiveWorkspaceId)(),n=Object.values(e).map((e=>e.id));return(0,w.jsxs)(s.Z,{direction:"column",gap:"spacing-s",children:[(0,w.jsx)($,{children:"Packages"}),(0,w.jsx)(le,{parsedPackagesId:n,handleAddPackages:t}),(0,w.jsx)("div",{onClick:()=>{K.AnalyticsService.addEventV2({category:"package_library",action:"open_package_library",variantId:"ide"})},children:(0,w.jsx)(P.Link,{to:`/workspace/${r}/package-library`,customNavEvent:"VIEW_COLLECTION_FOLDER_REQUEST",children:(0,w.jsxs)(s.Z,{alignItems:"center",gap:"spacing-xs",children:[(0,w.jsx)(_.ZP,{type:"link-default",children:"Open package library"}),(0,w.jsx)(B.Z,{color:"content-color-link"})]})})})]})},ue=a().div.withConfig({displayName:"divider__Divider",componentId:"sc-1xjgcud-0"})(["height:1px;background-color:var(--border-color-default);width:100%;margin-top:var(--spacing-s);margin-bottom:var(--spacing-s);"]),pe=D().getExamples("prerequest");function he({onSelect:e,packages:t,handleAddPackages:r,isPackageLibraryEnabled:n}){return(0,w.jsxs)(W,{children:[n&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(de,{packages:t,handleAddPackages:r}),(0,w.jsx)(ue,{})]}),(0,w.jsxs)(s.Z,{direction:"column",height:"100%",children:[(0,w.jsx)($,{children:"Snippets"}),(0,w.jsx)(V,{children:pe.map(((t,r)=>(0,w.jsx)(U,{"data-id":r,title:t.description,onClick:()=>null==e?void 0:e(t.code),children:t.name},r)))})]})]})}const ge=a()(s.Z).withConfig({displayName:"scripts-panel-layout__FullHeightContainer",componentId:"sc-7b6861-0"})(["height:calc(100% - var(--spacing-s));"]),me=a().div.withConfig({displayName:"scripts-panel-layout__LeftPanel",componentId:"sc-7b6861-1"})(["flex:1 1 70%;width:calc(100% - ","px - var(--text-size-m));"],250),fe=a().div.withConfig({displayName:"scripts-panel-layout__RightPanel",componentId:"sc-7b6861-2"})(["flex:0 0 auto;max-width:","px;padding-left:var(--spacing-m);font-size:var(--text-size-s);"],250);function ve(e){return(0,w.jsx)(s.Z,{direction:"column",height:"100%",width:"100%",grow:1,children:(0,w.jsxs)(ge,{children:[(0,w.jsx)(me,{"data-testid":"script-left-panel",children:e.leftPanel}),(0,w.jsx)(fe,{"data-testid":"script-right-panel",children:e.rightPanel})]})})}var be=r(34583),ye=r(97201);const xe=async(e,t,r)=>{const n=`const ${(0,be.camelCase)(e)} = pm.require('${t}');\n`;r.executeEdits("execute-edits",[{range:{startLineNumber:1,startColumn:1,endLineNumber:1,endColumn:1},text:n,forceMoveMarkers:!0}]);const i={lineNumber:1,column:n.length+1};r.setPosition(i),r.pushUndoStop()};var ke=r(1590);const we=(0,n.lazy)((0,ke.loadRemoteModule)("code-editor/CodeEditor")),je=i().forwardRef(((e,t)=>(0,w.jsx)(n.Suspense,{fallback:(0,w.jsx)(l.Z,{}),children:(0,w.jsx)(we,Object.assign({},e,{ref:t}))}))),Se={"pre-script":async()=>(await r.e(1394).then(r.t.bind(r,11394,17))).default,"tests-script":async()=>(await r.e(6773).then(r.t.bind(r,16773,17))).default};const Ce=e=>e.charAt(0).toUpperCase()+e.slice(1),Ie=e=>"string"==typeof e?e:"object"==typeof e?JSON.stringify(e):String(e),_e=["jsLib","node","postman-collection","chai"],Ee=(0,n.forwardRef)((({content:e,onChange:t,onSetPackages:i,isPackagesEnabled:o,type:a="pre-script"},s)=>{const[c,l]=(0,n.useState)([]),[d,u]=(0,n.useState)(null),[p,h]=(0,n.useState)([]),m=(0,n.useRef)(null),{data:f,globalNameToIdMap:v}=(0,Z.usePackagesWithGlobalName)(),b=(()=>{const{data:e}=(0,g.useActiveAndDynamicVariables)();return(0,n.useCallback)(((t,r)=>{const n=new RegExp(/pm.(environment|globals|collectionVariables|variables).(((get|set|unset|has)\(('|").*))$/),i=t.getWordBeforePosition(r);let o=t.getLineContent(r.lineNumber);o&&(o=o.slice(0,Math.max(0,r.column-1)));let a=[];const s=n.exec(o);if(!s||s.length<6)return[];const c=s[1],l=e;let d=[];if(!l)return[];const u={globals:"globals",environment:"environment",collectionVariables:"collection"};if("variables"===c)d=l.filter((e=>Ie(e.key).toLowerCase().includes(i.word.toLowerCase())));else if(u[c]){const e=u[c];d=l.filter((t=>t.scope===e&&"dynamic"!==t.type&&Ie(t.key).toLowerCase().includes(i.word.toLowerCase())))}return p=d,h={startLineNumber:r.lineNumber,endLineNumber:r.lineNumber,startColumn:i.startColumn,endColumn:i.endColumn},a=p.map((e=>{let t={environment:"a",collection:"b",global:"c"}[e.scope]||"y";return"dynamic"===e.type?(t="z",{label:e.key,detail:`Details: ${Ie(e.description)}`,documentation:`Scope: ${Ce(e.scope)}\n\n`,insertText:e.key,range:h,sortText:`${t}-${e.key}`}):{label:e.key,detail:`Current: ${e.sessionValue}`,documentation:`Initial: ${Ie(e.value)} \nScope: ${Ce(e.scope)}\n\n`,insertText:e.key,range:h,sortText:`${t}-${e.key}`}})),a;var p,h}),[e])})(),y=async e=>{try{const t=Object.entries(e).filter((([e])=>v.get(e))).map((([e,{id:t}])=>(async(e,t)=>{if(!m.current)throw new Error("Worker pool not initialized");const r=f.find((t=>t.id===e)),n=null==r?void 0:r.indexScript.id;if(!n)throw new Error(`Script ID not found for package: ${t}`);const i=await(async(e,t)=>{try{return await ye.cacheClient.fetchQuery((0,Z.getScriptQuery)(e,t))}catch(e){throw console.error("Error fetching script content:",e),e}})(e,n),o=await m.current.execute({jsCode:i.contents.src,packageName:r.name});return{id:`${t}-${new Date(i.lastRetrievedAt).getTime()}`,content:o.result||""}})(t,e))),r=((e,t)=>{if(!d)return e;let r="";const n=new Set(Object.values(t).map((({id:e})=>e)));return r=`\n      ${r}\n      declare interface Postman { ${f.filter((e=>n.has(e.id))).map((e=>`require(name: '${null==e?void 0:e.globalName}'): typeof import('${null==e?void 0:e.name}');`)).join("\n")} }\n    `,[{id:`${d.id}-${Math.random()}`,content:`${d.content}\n      ${r}\n      `},...e]})((await Promise.all(t)).filter((e=>e.content)),e);h(r)}catch(e){console.error("Error adding package libraries:",e)}},x=(0,be.debounce)((async e=>{const{parsedRequireStatements:t,validationErrors:n,parseError:o}=await async function(e){let t;const n=await async function(){return r.e(8511).then(r.t.bind(r,78511,23))}(),i=[],o=[];try{t=n.createSourceFile("code.js",e,n.ScriptTarget.Latest)}catch(e){return{parseError:!0}}return function e(t){if(n.isCallExpression(t)){const{expression:e}=t;if(n.isPropertyAccessExpression(e)&&n.isIdentifier(e.expression)&&"pm"===e.expression.text&&n.isIdentifier(e.name)&&"require"===e.name.text){const e=t.arguments[0];if(e&&n.isStringLiteral(e))i.push(e.text);else{const r=e&&n.getLineAndCharacterOfPosition(t.getSourceFile(),e.pos);o.push({message:"pm.require accepts only string literal as argument",startLineNumber:null==r?void 0:r.line,endLineNumber:null==r?void 0:r.line,startColumn:(null==r?void 0:r.character)+1,endColumn:(null==r?void 0:r.character)+1,severity:3})}}}n.forEachChild(t,e)}(t),{parsedRequireStatements:i,validationErrors:o}}(e);if(o||!t)return;n&&l(n);const a={};for(const e of t){const t=v.get(e);t&&(a[e]={id:t})}i(a),y(a)}),1e3,{leading:!0});return(0,n.useEffect)((()=>(o&&((async()=>{try{const e=await(async()=>{const e=await fetch(`${window.BASE_URL_PREFIX}/http-workbench/script-parser-worker.js`),t=await e.blob(),r=URL.createObjectURL(t);return new Worker(r)})(),t=function(e,t,r){const n=[],i=[];let o;function a(){const t=e();return t.busy=!1,t.addEventListener("message",c),t.addEventListener("error",c),t}function s(){clearTimeout(o);const e=n.find((e=>!e.busy));if(e&&i.length>0){const t=i.shift();if(t){const{data:i,resolve:o,reject:a}=t;e.busy=!0,e.currentTask=i,e.postMessage(i),e.taskResolve=o,e.taskReject=a,e.taskTimeoutId=setTimeout((()=>{var t;(t=e).busy&&(t.taskTimeoutId=void 0,null==t.taskReject||t.taskReject(new Error(`Task execution timed out after ${r}ms`)),t.terminate(),function(e){const t=n.indexOf(e);-1!==t&&n.splice(t,1)}(t),s())}),r)}}else 0===i.length&&(o=setTimeout((()=>{l()}),r))}function c(e){const t=e.target;t.taskTimeoutId&&(clearTimeout(t.taskTimeoutId),t.taskTimeoutId=void 0),t.busy=!1,t.currentTask=void 0,"message"===e.type?null==t.taskResolve||t.taskResolve(e.data):null==t.taskReject||t.taskReject(e.message),t.taskResolve=void 0,t.taskReject=void 0,s()}function l(){for(const e of n)e.taskTimeoutId&&(clearTimeout(e.taskTimeoutId),e.taskTimeoutId=void 0),e.terminate();n.length=0}return{execute:function(e){return new Promise(((r,o)=>{i.push({data:e,resolve:r,reject:o}),function(){for(;n.length<t;)n.push(a())}(),s()}))},terminateWorkers:l}}((()=>e),3,1e4);m.current=t}catch(e){console.error("Failed to set up script parser worker pool:",e)}})(),(async e=>{try{const t={id:e,content:await Se[e]()};return u(t),t}catch(e){return""}})(a)),()=>{var e;null==(e=m.current)||e.terminateWorkers()})),[o]),(0,w.jsx)(je,{ref:s,showNonPrintableCharacters:!0,fontSize:12,language:"javascript",codeCompletionProviders:[{provider:b}],wordWrap:!0,autoFormat:!0,value:e,onChange:e=>{t(e),o&&x(e)},typeDefinitionTypes:[..._e,...p],validationErrors:c})})),Pe=(0,m.observer)((function(){const e=(0,n.useRef)(null),[t,r]=x(),[i,o]=function(){const e=Be();return[e.preRequestStore.packages,e.onPreRequestScriptPackageChange]}(),{isEnabled:a}=(0,Z.useIsPackageEnabled)(),s=(0,n.useCallback)((t=>{var r;null==(r=e.current)||r.insertTextBlock(t)}),[]);return(0,w.jsx)(ve,{leftPanel:(0,w.jsx)(Ee,{ref:e,content:t,onChange:r,onSetPackages:o,isPackagesEnabled:a,type:"pre-script"}),rightPanel:(0,w.jsx)(he,{onSelect:s,packages:i,handleAddPackages:(t,r)=>{var n;const i=null==(n=e.current)?void 0:n.editor;i&&xe(t,r,i)},isPackageLibraryEnabled:a})})})),Te=D().getExamples("test");function Ae({onSelect:e,packages:t,handleAddPackages:r,isPackageLibraryEnabled:n}){return(0,w.jsxs)(W,{children:[n&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(de,{handleAddPackages:r,packages:t}),(0,w.jsx)(ue,{})]}),(0,w.jsxs)(s.Z,{direction:"column",height:"100%",children:[(0,w.jsx)($,{children:"Snippets"}),(0,w.jsx)(V,{children:Te.map(((t,r)=>(0,w.jsx)(U,{"data-id":r,title:t.description,onClick:()=>null==e?void 0:e(t.code),children:t.name},r)))})]})]})}const Le=(0,m.observer)((function(){const e=(0,n.useRef)(null),[t,r]=k(),[i,o]=function(){const e=Be();return[e.testScriptStore.packages,e.onTestScriptPackageChange]}(),{isEnabled:a}=(0,Z.useIsPackageEnabled)(),s=(0,n.useCallback)((t=>{var r;null==(r=e.current)||r.insertTextBlock(t)}),[]);return(0,w.jsx)(ve,{leftPanel:(0,w.jsx)(Ee,{ref:e,content:t,onChange:r,onSetPackages:o,isPackagesEnabled:a,type:"tests-script"}),rightPanel:(0,w.jsx)(Ae,{onSelect:s,packages:i,handleAddPackages:(t,r)=>{var n;const i=null==(n=e.current)?void 0:n.editor;i&&xe(t,r,i)},isPackageLibraryEnabled:a})})})),Ne=a()(s.Z).withConfig({displayName:"scripts-panel__ScriptList",componentId:"sc-1cbtgmk-0"})(["width:",";border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);"],(({isScriptWidthNarrow:e})=>e?"81px":"115px")),Re=a()(s.Z).withConfig({displayName:"scripts-panel__ScriptContainer",componentId:"sc-1cbtgmk-1"})(["flex:1 1 auto;min-width:0;"]),Ze=(0,m.observer)((({isScriptWidthNarrow:e})=>{const[t,r]=(0,n.useState)(I),[i]=x(),[o]=k(),a=[{key:I,label:e?"Pre-req":"Pre-request",hasValue:!!i,tooltipText:"Runs before each request is sent. Use it to create API workflows by configuring the requests dynamically.",tooltipLearnMoreLink:"https://go.pstmn.io/docs-prerequest-scripts"},{key:"postresponse",label:e?"Post-res":"Post-response",hasValue:!!o,tooltipText:"Runs after a response is received for each request. Use it to write tests.",tooltipLearnMoreLink:"https://go.pstmn.io/docs-test-scripts"}];return(0,w.jsxs)(s.Z,{width:"100%",height:"100%",padding:{paddingTop:"spacing-s"},children:[(0,w.jsx)(Ne,{isScriptWidthNarrow:e,direction:"column",children:a.map((e=>(0,w.jsx)(R,{script:e,setActiveScriptKey:r,activeScriptKey:t},e.key)))}),(0,w.jsx)(Re,{children:t===I?(0,w.jsx)(Pe,{}):(0,w.jsx)(Le,{})})]})}));var Oe=r(60398);class De{parsePayload(e){const t=null==e?void 0:e.find((e=>e.listen===this.type));return t?t.script.exec.join("\n"):""}parsePackages(e){var t,r;const n=null==e?void 0:e.find((e=>e.listen===this.type));return null!=(t=null==n||null==(r=n.script)?void 0:r.packages)?t:{}}constructor(e,t){this.type=void 0,this.content="",this.packages={},this.update=e=>{this.content=this.parsePayload(e),this.packages=this.parsePackages(e)},this.setContent=e=>{this.content=e},this.setPackages=e=>{this.packages=e},this.type=e,this.content=this.parsePayload(t),this.packages=this.parsePackages(t),(0,b.makeObservable)(this,{content:!0,packages:!0,setContent:b.action,setPackages:b.action})}getPayload(){return this.content?[{listen:this.type,script:{id:(0,Oe.v4)(),exec:this.content.split("\n"),type:"text/javascript",packages:this.packages}}]:[]}}var Fe=r(53186),ze=r(18767);const qe=e=>e&&"object"==typeof e?e.auth?{name:e.name,id:e.id,auth:e.auth,type:"folder"}:qe(e.folder):null;function Me(e,t){var r,n,i,o;if(e===t)return!0;if(!e||!t)return!1;const a=(null==(r=e.find((e=>"test"===e.listen)))?void 0:r.script.exec)||[],s=(null==(n=t.find((e=>"test"===e.listen)))?void 0:n.script.exec)||[],c=(null==(i=e.find((e=>"prerequest"===e.listen)))?void 0:i.script.exec)||[],l=(null==(o=t.find((e=>"prerequest"===e.listen)))?void 0:o.script.exec)||[];return Array.isArray(a)&&Array.isArray(s)&&JSON.stringify(a)===JSON.stringify(s)&&Array.isArray(c)&&Array.isArray(l)&&JSON.stringify(c)===JSON.stringify(l)}const We=["activeAuthType"];class $e{constructor({folderId:e}){this.folderId=void 0,this.isLoading=!0,this.error=null,this.unsubscribeFromFolderCache=void 0,this.unsubscribeFromPermissionsCache=void 0,this.metadata={},this.preRequestScript="",this.tests="",this.preRequestStore=new De("prerequest",[]),this.testScriptStore=new De("test",[]),this.folderAuthState=Object.assign({activeAuthType:"noauth",type:"noauth"},ze.initialAuthState),this.folderAuthSessionState=ze.defaultAuthSession,this.trackedState={},this.isConflicted=!1,this.isSaving=!1,this.permissions={},this.inheritAuthParent=null,this.collection={},this.folder={},this.cachedFolderItem=void 0,this.startListeningToFolderCache=()=>{var e;const t=new ye.CacheObserver(ye.cacheClient,(0,Fe.folderFindOneQuery)({folderId:this.folderId})),r=t.getCurrentResult();this.onFolderCacheUpdate(r),this.cachedFolderItem=null==(e=r.data)?void 0:e.data,this.unsubscribeFromFolderCache=t.subscribe(this.onFolderCacheUpdate)},this.startListeningToCollectionsCache=e=>{if(e){const t=new ye.CacheObserver(ye.cacheClient,(0,Fe.collectionPermissionsQuery)({collectionId:e})),r=t.getCurrentResult();this.onCollectionPermissionsUpdate(r),this.unsubscribeFromPermissionsCache=t.subscribe((e=>{this.onCollectionPermissionsUpdate(e)}))}},this.onCollectionPermissionsUpdate=e=>{const t=e.data;t&&(0,b.runInAction)((()=>{this.permissions=t}))},this.setTrackedState=(e,t)=>{e&&(this.trackedState=Object.assign({},this.trackedState,{[e]:t}))},this.setPreRequestScript=e=>{(0,b.transaction)((()=>{this.preRequestStore.setContent(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)}))},this.setTests=e=>{(0,b.transaction)((()=>{this.testScriptStore.setContent(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)}))},this.onPreRequestScriptPackageChange=e=>{this.preRequestStore.setPackages(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)},this.onTestScriptPackageChange=e=>{this.testScriptStore.setPackages(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)},this.setFolderAuthState=e=>{(0,b.transaction)((()=>{this.folderAuthState=e;const{activeAuthType:t}=e,r=(0,v.Z)(e,We);if("inherit"===t)return void this.setTrackedState("auth",null);const n=Object.assign({},r,{type:t});this.setTrackedState("auth",n)}))},this.setFolderAuthSessionState=e=>{this.folderAuthSessionState=e},this.setMetadata=e=>{!this.metadata.collection&&e.collection&&this.startListeningToCollectionsCache(e.collection),this.metadata=e},this.setDescription=e=>{(0,b.transaction)((()=>{this.metadata.description=e,this.setTrackedState("description",this.metadata.description)}))},this.setIsSaving=e=>{this.isSaving=e},this.onFolderCacheUpdate=e=>{var t;const r=null==(t=e.data)?void 0:t.data;this.isLoading=!r&&!e.error,this.error=e.error;const{incomingChanges:n,isConflicted:i}=function(e,t,r,n){const i={};let o=!1;if(!t)return{incomingChanges:e,isConflicted:o};for(const n of["name","auth","events","description","collection","folder"])switch(n){case"events":Me(e[n],t[n])||(r[n]?o=!0:i[n]=e[n]);break;case"auth":case"name":case"description":e[n]!==t[n]&&n in r?o=!0:e[n]!==t[n]&&(i[n]=e[n]);break;case"collection":case"folder":var a,s;(null==(a=e[n])?void 0:a.id)!==(null==(s=t[n])?void 0:s.id)&&(i[n]=e[n])}return{incomingChanges:i,isConflicted:o}}(r,this.cachedFolderItem,this.trackedState);var o;if(r&&this.isDirty&&!this.isSaving&&this.cachedFolderItem&&i&&(0,b.runInAction)((()=>{this.isConflicted=!0})),n&&Object.keys(n).length>0&&((0,b.runInAction)((()=>{var e,t,n,i;this.folderAuthState=!(i=null!=(e=this.trackedState.auth)?e:r.auth)||"object"==typeof i&&0===Object.keys(i).length?Object.assign({activeAuthType:"inherit",type:"inherit"},ze.initialAuthState):Object.assign({},ze.initialAuthState,i,{activeAuthType:i.type||"noauth"}),this.preRequestStore.update(null!=(t=this.trackedState.events)?t:r.events),this.testScriptStore.update(null!=(n=this.trackedState.events)?n:r.events)})),this.collection=r.collection,this.folder=r.folder,this.setMetadata({id:r.id,name:r.name,description:r.description,collection:null==(o=r.collection)?void 0:o.id}),this.cachedFolderItem=r),r){const e=(e=>{var t,r,n,i,o;let a=qe(e.folder);return a||(a=null!=(t=e.collection)&&t.auth?{id:null==(r=e.collection)?void 0:r.id,name:null==(n=e.collection)?void 0:n.name,auth:e.collection.auth,type:"collection"}:{id:null==(i=e.collection)?void 0:i.id,name:null==(o=e.collection)?void 0:o.name,auth:Object.assign({type:"noauth"},ze.initialAuthState),type:"collection"},a)})(r);this.setInheritAuthParent(e)}},this.setInheritAuthParent=e=>{this.inheritAuthParent=e},this.folderId=e,(0,b.makeObservable)(this,{isLoading:!0,error:!0,breadcrumbs:b.computed,metadata:b.observable.ref,name:b.computed,setMetadata:b.action,preRequestScript:!0,folderAuthState:!0,setFolderAuthState:b.action,folderAuthSessionState:!0,setFolderAuthSessionState:b.action,tests:!0,setTests:b.action,onFolderCacheUpdate:b.action,isDirty:b.computed,trackedState:!0,setTrackedState:b.action,isConflicted:!0,setIsSaving:b.action,isSaving:!0,permissions:!0,inheritAuthParent:!0,setInheritAuthParent:b.action,onPreRequestScriptPackageChange:b.action,onTestScriptPackageChange:b.action}),this.startListeningToFolderCache()}get isDirty(){return Object.keys(this.trackedState).length>0}get breadcrumbs(){return((e,t,r)=>{var n,i;let o=[],a={};return a={id:null!=(n=e.id)?n:"DEFAULT",name:null!=(i=null==e?void 0:e.name)?i:y,entityType:"leafFolder"},o=(0,Fe.getBreadcrumbItems)("",t,r),o.push(a),o})(this.metadata,this.collection,this.folder)}get name(){var e;return null!=(e=this.metadata.name)?e:y}resetTrackedStateChanges(){(0,b.runInAction)((()=>{this.trackedState={},this.isConflicted=!1}))}rollbackUpdates(e,t){(0,b.runInAction)((()=>{this.trackedState=e,this.isConflicted=t}))}destroy(){var e,t;null==(e=this.unsubscribeFromFolderCache)||e.call(this),null==(t=this.unsubscribeFromPermissionsCache)||t.call(this),this.trackedState={}}}const Ve=(0,n.createContext)({}),Ue=({children:e})=>{if(!(0,f.useInRouterContext)())throw new Error("FolderEditorProvider must be used within a Router");const{folderId:t}=(0,f.useParams)(),r=(0,n.useMemo)((()=>new $e({folderId:t})),[]);return(0,n.useEffect)((()=>()=>r.destroy()),[]),(0,w.jsx)(Ve.Provider,{value:r,children:e})},Be=()=>{const e=i().useContext(Ve);if(!e)throw new Error("useFolderEditorStore should be used within a FolderEditorContext.Provider");return e},He=()=>Be().name,Ke=()=>{const e=Be();return[e.metadata,e.setMetadata]};var Je=r(49886),Qe=r(24502);const Ge=()=>{const e=Be();return{isDirty:e.isDirty,isSaving:e.isSaving,isConflicted:e.isConflicted}};var Ye=r(19578);const Xe=["mutate"],et=(0,Fe.updateFolderMutation)(),tt=()=>{const e=Be(),t=(0,ye.useMutation)(et),{mutate:r}=t,n=(0,v.Z)(t,Xe);return Object.assign({mutate:t=>{const n=e.trackedState,i=e.isConflicted;return t&&(n.name=t),e.resetTrackedStateChanges(),e.setIsSaving(!0),r({folderId:e.folderId,patch:n},{onError:()=>{e.rollbackUpdates(n,i),Ye.Toast.getToasts().addToast({title:"Unable to save changes",description:"Could not save changes. Please try again.",status:"error"})},onSettled:()=>{e.setIsSaving(!1)}})}},n)},rt=tt,nt=new Set(["Alt","Meta","Control","Shift"]),it=()=>{var e,t;const r=Be();return 0===Object.keys(r.permissions).length?{canEdit:!0,canDelete:!0}:{canEdit:null==(e=r.permissions[Fe.CollectionPermissionNames.UPDATE_COLLECTION])?void 0:e.allowed,canDelete:null==(t=r.permissions[Fe.CollectionPermissionNames.DELETE_COLLECTION])?void 0:t.allowed}};var ot=r(38394),at=r(95617),st=r(26663),ct=r.n(st);const lt=({pathname:e})=>{const[t,r]=(0,n.useState)(!1),i=(0,n.useRef)(),o=(0,n.useCallback)((()=>{const t=ct().ARTEMIS_URL;navigator.clipboard.writeText(t+e).then((()=>{r(!0),null!=i&&i.current&&clearTimeout(i.current),i.current=setTimeout((()=>{r(!1)}),1500)}))}),[e,i]);return(0,w.jsx)(p.Z,{type:"tertiary",className:"copy-link-btn",size:"small",icon:t?(0,w.jsx)(ot.Z,{size:"small",color:"base-color-success"}):(0,w.jsx)(at.Z,{size:"small"}),onClick:o,tooltip:"Copy link to folder"})},dt=(0,n.lazy)((0,ke.loadRemoteModule)("collection-runner/RunCollectionButton")),ut=a().div.withConfig({displayName:"folder-meta-header__FolderMetaHeaderContainer",componentId:"sc-1b6q3wk-0"})(["display:flex;flex-direction:'row';justify-content:space-between;box-sizing:border-box;height:48px;padding:var(--spacing-s) var(--spacing-s);border-bottom:var(--border-width-default) var(--border-style-solid) var(--border-color-default);"]),pt=a().div.withConfig({displayName:"folder-meta-header__BreadcrumbContainer",componentId:"sc-1b6q3wk-1"})(["color:var(--content-color-primary);font-weight:var(--text-weight-medium);width:100%;nav{.copy-link-btn{display:none;}:hover{.copy-link-btn{display:inline-flex;}}}"]),ht=a()(s.Z).withConfig({displayName:"folder-meta-header__LeftSectionRow",componentId:"sc-1b6q3wk-2"})(["overflow:hidden;width:100%;"]),gt=(0,m.observer)((()=>{const e=Be().breadcrumbs,t=He(),{isDirty:r,isConflicted:i}=Ge(),{canEdit:o}=it(),{mutate:a}=tt(),[c]=Ke(),p=(0,P.useNavigate)(),{pathname:h}=(0,P.useLocation)(),g=(0,H.useActiveWorkspaceId)(),m=e=>{e!==t&&a(e)},f=(0,n.useRef)(null),{rename:v}=(0,P.useAdditionalRouteContext)();(0,n.useEffect)((()=>{var e;v&&(null==(e=f.current)||e.triggerRenameMode())}),[v]);const{setTabTitle:b}=(0,P.useTabTitleMeta)();return(0,n.useEffect)((()=>{b(t,"folder",{isDirty:r,isConflicted:i})}),[t,r,i]),null!=c&&c.name?(0,w.jsx)(ht,{direction:"row",shrink:"1",grow:"0",alignItems:"center",gap:"spacing-s",children:(0,w.jsx)(pt,{children:e&&(0,w.jsx)(d.aG,{metaInfo:{custom:(0,w.jsx)(s.Z,{alignItems:"center",gap:"spacing-s",children:!o&&(0,w.jsx)(Je.Z,{title:"You do not have permissions to edit this folder"})})},appendActions:(0,w.jsx)(lt,{pathname:h}),onItemClick:e=>{p(`/workspace/${g}/${e.entityType}/${e.id}`,{},{customNavEvent:"VIEW_COLLECTION_FOLDER_REQUEST"})},ref:f,children:e.map((e=>(0,w.jsx)(u.Z,{enableRename:"leafFolder"===e.entityType&&o,renameInputConfig:{onSubmit:m,value:t},itemData:e,children:e.name},e.name)))})})}):(0,w.jsx)(l.Z,{})})),mt=(0,m.observer)((()=>{const{isDirty:e,isSaving:t,isConflicted:r}=Ge(),{mutate:i}=tt(),{canEdit:o}=it(),a=(0,H.useActiveWorkspaceId)(),{userCanRunCollection:c}=(0,Fe.useWorkspacePermissions)(a),d=o&&e,u=He(),m=h.Modals.getModals(),[f]=Ke(),v=async()=>{if(!o||!e)return;if(!r)return i();const t=await m.showWarningDialog({uid:"folder-workbench-tab-conflict-confirmation",subject:"DO YOU WANT TO SAVE?",message:`This tab ${u} has been modified from another tab. Saving these changes will overwrite this folder.`,options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Save and overwrite",isPrimary:!0}]});return t&&"Save and overwrite"===t.title?i():void 0};return(({ctrlKey:e,shiftKey:t,altKey:r,keys:i,callback:o})=>{const a=(0,n.useRef)([]),s=(0,n.useRef)(!1),c=(0,n.useRef)(!1),l=(0,n.useRef)(!1),d=(0,n.useRef)(null),u=(0,n.useRef)(o);u.current=o,(0,n.useEffect)((()=>{const n=n=>{if((n.ctrlKey||n.metaKey)&&(s.current=!0),n.shiftKey&&(c.current=!0),n.altKey&&(l.current=!0),!nt.has(n.key)&&Array.isArray(i)){const e=i.findIndex((e=>e.toLowerCase()===n.key.toLowerCase()));-1!==e&&(a.current[e]=n.key)}const o=!e||s.current,p=!t||c.current,h=!r||l.current;if(d.current=setTimeout((()=>{s.current=!1,c.current=!1,l.current=!1,a.current=[]}),2500),o&&p&&h){if(Array.isArray(i)&&((e,t)=>{let r=0;for(const i of e){var n;if(i.toLowerCase()!==(null==(n=t[r])?void 0:n.toLowerCase()))return!1;r++}return!0})(i,a.current))return u.current();if(i===n.key)return u.current()}};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n),d.current&&clearTimeout(d.current)}}),[e,t,r,i])})({ctrlKey:!0,keys:"s",callback:v}),(0,w.jsxs)(s.Z,{className:"request-meta-header-right-section",direction:"row",alignItems:"center",gap:"spacing-s",children:[(0,w.jsx)(n.Suspense,{fallback:(0,w.jsx)(l.Z,{}),children:(0,w.jsx)(dt,{isDisabled:!c,collectionId:f.collection,folderId:f.id})}),(0,w.jsx)(p.Z,{type:"tertiary",text:t?"Saving...":"Save",isDisabled:!d||t,onClick:v,icon:(0,w.jsx)(Qe.Z,{})}),(0,w.jsx)(g.ActiveEnvironmentSelector,{})]})})),ft=()=>(0,w.jsxs)(ut,{children:[(0,w.jsx)(gt,{}),(0,w.jsx)(mt,{})]});var vt=r(15761),bt=r(27366),yt=r(71132),xt=r(27162),kt=r(5246);const wt=()=>{const e=Be();return[e.folderAuthState,e.setFolderAuthState]};var jt=r(71453);const St=a()(s.Z).withConfig({displayName:"folder-no-auth__NoAuthContainer",componentId:"sc-1cr6t6a-0"})(["width:100%;height:100%;align-items:center;justify-content:center;text-align:center;"]),Ct=a()(P.Link).withConfig({displayName:"folder-no-auth__AuthorizationLink",componentId:"sc-1cr6t6a-1"})(["display:inline-flex;align-items:center;text-decoration:underline;color:var(--content-color-secondary);"]),It=()=>(0,w.jsxs)(Ct,{type:"link-default",to:"https://go.pstmn.io/docs-auth",target:"_blank",rel:"noopener noreferer",children:["authorization",(0,w.jsx)(jt.Z,{})]}),_t=()=>(0,w.jsx)(St,{children:(0,w.jsxs)("div",{children:["This folder does not use any authorization. Learn more about ",(0,w.jsx)(It,{})]})}),Et=a()(s.Z).withConfig({displayName:"folder-inherit-auth__InheritAuthContainer",componentId:"sc-wwddkg-0"})(["align-items:center;justify-content:center;text-align:center;"]),Pt=a()(P.Link).withConfig({displayName:"folder-inherit-auth__StyledLink",componentId:"sc-wwddkg-1"})(["text-decoration:underline;"]),Tt=(0,m.observer)((()=>{const e=Be().inheritAuthParent,t=((e,t)=>{switch(null==e?void 0:e.type){case"folder":return`/workspace/${t}/folder/${e.id}`;case"collection":return`/workspace/${t}/collection/${e.id}`;default:return""}})(e,(0,H.useActiveWorkspaceId)()),r=(e=>{const t=ze.supportedAuthOptions.find((t=>{var r;return t.value===(null==e||null==(r=e.auth)?void 0:r.type)}));return null==t?void 0:t.label})(e);return(0,w.jsx)(Et,{children:(0,w.jsxs)("div",{children:["This folder is using ",r," from ",null==e?void 0:e.type," ",(0,w.jsx)(Pt,{to:t,customNavEvent:"VIEW_COLLECTION_FOLDER_REQUEST",children:null==e?void 0:e.name})]})})})),At=(0,m.observer)((function(){const[e,t]=wt(),[r,i]=(()=>{const e=Be(),[t]=Ke(),{value:r,setValue:i}=(0,ze.useAuthSessionSafe)({model:"folder",modelId:t.id});return(0,n.useEffect)((()=>{r&&e.setFolderAuthSessionState(r)}),[r,e]),[e.folderAuthSessionState,(t,r)=>{const n=Object.assign({},e.folderAuthSessionState);n.oauth2||(n.oauth2=[]),n.oauth2=n.oauth2.filter((e=>"token_id"!==e.key)),n.oauth2.push({key:t,value:r}),i(n)}]})();return(0,w.jsx)(ze.AuthPanel,{authState:e,authSessionState:r,authDescriptions:{[ze.AUTH_OPTIONS.inherit]:(0,w.jsx)(Tt,{}),[ze.AUTH_OPTIONS.noauth]:(0,w.jsx)(_t,{})},setAuthState:t,setAuthSessionState:i})})),Lt=(0,m.observer)((()=>{const[e]=wt(),t=!["noauth","inherit"].includes(e.activeAuthType);return(0,w.jsxs)(w.Fragment,{children:["Authorization",t&&(0,w.jsx)(S,{})]})}));var Nt=r(83701);function Rt(e){const t=(0,n.useRef)();return t.current=e,(0,n.useCallback)(((...e)=>{const r=t.current;if(!r)throw new Error("Event handler wrapped in `useEventHandler` called during render, it may only be called in effects or at any other time.");return r(...e)}),[])}var Zt=r(43753);const Ot=(0,n.lazy)((0,ke.loadRemoteModule)("mimir-editor/MimirEditor")),Dt=i().forwardRef(((e,t)=>(0,w.jsx)(n.Suspense,{fallback:(0,w.jsx)(l.Z,{}),children:(0,w.jsx)(Ot,Object.assign({},e,{ref:t}))})));var Ft=r(21180);const zt="Postman editor",qt="context-view",Mt=a()(Nt.Z).withConfig({displayName:"folder-description-editor__DocumentationResponsiveContainer",componentId:"sc-lzi92f-0"})(["position:relative;font-size:var(--text-size-m);line-height:var(--line-height-m);width:100%;cursor:text;box-sizing:border-box;margin-top:",";border-radius:var(--border-radius-default);border:var(--border-width-default) var(--border-style-solid) transparent;"," &:hover{background-color:var(--background-color-secondary);background-color:",";}& .description-preview{padding:0;&__placeholder{padding:var(--spacing-m);}&__markdown{padding:var(--spacing-m);}}& .mimir{min-height:","px !important;& .editor__container{margin-top:6px;height:fit-content;& div[data-slate-editor='true']{min-height:","px !important;padding:var(--spacing-m);max-height:fit-content;width:auto;box-sizing:border-box;}}& .toolbar__anchor{height:auto;background:var(--background-color-primary);display:",";align-items:center;z-index:100;position:sticky;top:0;margin-top:-36px;background-color:transparent;border-radius:var(--border-radius-default);& .slate-HeadingToolbar{width:100%;min-height:unset;border-radius:var(--border-radius-default) var(--border-radius-default);border:var(--border-width-default) solid var(--border-color-strong);box-shadow:",";height:28px;.toolbar__wrapper{padding-right:0;}.toolbar__info{display:none;}.toolbar__list{height:fit-content;}.toolbar__dropdown{top:30px;}.toolbar__dropdown__heading{cursor:pointer;}& .toolbar__toggle{display:flex;padding-right:",";& > button{height:22px;padding:0 4px;margin-top:3px;}& .aether-dropdown__control{background:transparent;height:28px;border:none;&--is-focused{border:none;box-shadow:none;&:hover{border:none;box-shadow:none;}}}}}}","}"," ",""],(e=>e.source===qt?"34px":"0"),(e=>e.editable&&e.editMode&&(0,o.css)(["border-color:var(--base-color-info);"])),(e=>e.editable&&!e.editMode?"var(--background-color-secondary)":"transparent"),(e=>e.minimumEditorHeight),(e=>e.minimumEditorHeight),(e=>e.isInViewPort?"flex":"none"),(e=>"0px 2px 4px "+(e.theme["content-color-primary"]===Zt.dark["content-color-primary"]?"rgba(0, 0, 0, 0.2)":"rgba(0, 0, 0, 0.05)")),(e=>e.source===qt?"var(--spacing-s)":"0"),(e=>!e.editMode&&(0,o.css)(["a{cursor:pointer;}.slate-codeblock-wrapper{cursor:pointer;& pre{cursor:text;}}.image-balloon-container,.image-handle.handle-right,.image-handle.handle-left,.link-balloon-container.edit,.media-balloon-container,.link-balloon-container{display:none;}.image-element.selected .image-item{opacity:1;box-shadow:unset;}"])),(e=>!e.editMode&&(0,o.css)(["[contenteditable] ~ grammarly-extension,input ~ grammarly-extension,textarea ~ grammarly-extension{display:none;}"])),(e=>e.editMode?(0,o.css)(["figure{.image-caption::placeholder{visibility:visible;}}"]):(0,o.css)(["figure{.image-caption::placeholder{visibility:hidden;}}"]))),Wt=a().div.withConfig({displayName:"folder-description-editor__SavingLoader",componentId:"sc-lzi92f-1"})(["position:absolute;inset:0;background-color:var(--background-color-primary);opacity:0.75;z-index:1;transition:opacity 100ms ease-in-out;"]),$t=({source:e,onSave:t,editable:r,isOffline:i,entityType:o,placeholder:a,entityDescription:s,modelDetails:c,isEntityLoading:l,resolvedEntityDescription:d,minimumEditorHeight:u=75,disableMarkdownEditor:p=!1,updateParentAboutContainerDimension:h,isBigFontSize:g=!1})=>{var m,f;const v=(0,n.useRef)(),b=(0,n.useRef)(!1),[y,x]=(0,n.useState)(!1),[k,j]=(0,n.useState)(s),[S,C]=(0,n.useState)(zt),I=zt,[_,E]=(0,n.useState)(null!=d?d:s);(0,n.useEffect)((()=>{j(s),E(d)}),[s,d]);const T=Rt((()=>{r&&(C(I),x(!0))})),[A,L]=((e,t,r)=>{const i=(0,n.useRef)(null),o=(0,n.useRef)(0),a=(0,n.useRef)(),s=(0,n.useRef)(!1),c=(0,n.useRef)(!1),[l,d]=(0,n.useState)(!1),u=Rt((t=>{const r=t.target,n=null!==r.closest(".slate-codeblock-wrapper")&&null==r.closest("pre"),a=void 0!==r.ownerSVGElement,c=null!==r.closest(".markdown-editor")||null!==r.closest(".toolbar__toggle")||null!==r.closest(".team-usage-error"),l=null!==r.closest(".media-element"),d=r.closest("[data-entity-id='click-to-expand-button']");if(n||a||c||d)return;l&&(t.preventDefault(),t.stopPropagation());const u=null!==r.closest("a");if(u){var p;t.preventDefault();const e=r.closest("a"),n=null==e?void 0:e.href,o=null==(p=i.current)?void 0:p.querySelector(":focus");null==o||o.blur(),n&&(0,P.openExternalLink)(n)}s.current||o.current>1||u||e()})),p=Rt((t=>{if(2!==t.button){if(""===r)return e();o.current=t.detail,c.current=!0,a.current&&(clearTimeout(a.current),a.current=void 0),a.current=setTimeout((()=>{1===o.current&&u(t),o.current=0}),300)}})),h=Rt((e=>{2!==e.button&&(c.current=!1)})),g=Rt((()=>{s.current=!!c.current})),m=Rt((t=>{const r=t.target,n=null!==(null==r?void 0:r.closest(".markdown-editor"))||null!==(null==r?void 0:r.closest(".toolbar__toggle"));(t.ctrlKey||t.metaKey)&&"c"===t.key||n||!i.current||t.target!==i.current&&!i.current.contains(t.target)||1!==t.key.length&&"Backspace"!==t.key&&"Delete"!==t.key&&"Enter"!==t.key&&"Tab"!==t.key||e()}));return(0,n.useEffect)((()=>{if(t)return;const e=i.current;return null==e||e.addEventListener("mouseup",h),null==e||e.addEventListener("mousedown",p),null==e||e.addEventListener("mousemove",g),null==e||e.addEventListener("keydown",m),()=>{null==e||e.removeEventListener("mouseup",h),null==e||e.removeEventListener("mousedown",p),null==e||e.removeEventListener("mousemove",g),null==e||e.removeEventListener("keydown",m)}}),[t]),(0,n.useEffect)((()=>{const e=new IntersectionObserver((([e])=>d(e.isIntersecting)),{threshold:0});return i.current&&e.observe(i.current),()=>{i.current&&e.unobserve(i.current)}}),[]),[i,l]})(T,y,k),N=Rt((e=>{A.current&&(A.current.style.minHeight=`${e}px`,h&&h(e))})),R=Rt((e=>{b.current=!!e})),Z=(0,n.useCallback)((async()=>{if(!b.current&&!i&&t&&v.current){var e,r;const n=null!=s?s:"",i=null!=(e=null==(r=v.current)?void 0:r.slateToMD())?e:"",o=n!==i;try{o&&(await t(i),K.AnalyticsService.addEventV2({category:"documentation",action:"save",label:"overview",value:1,entityType:"folder"})),x(!1)}catch(e){T()}}}),[i,s,null==v?void 0:v.current,null==b?void 0:b.current]);return(0,w.jsx)(Ft.CustomErrorBoundary,{appId:"folder-workbench",errorElementId:"folder-description-editor",fallback:(0,w.jsx)(Ft.GenericErrorMessage,{title:"Couldn't load documentation",description:"Just a faulty wire. Try reloading.",illustration:"illustration-internal-server-error"}),children:(0,w.jsxs)(Mt,{ref:A,isInViewPort:L,type:"column",span:8,mobile:12,overflow:"unset",editMode:y,minimumEditorHeight:u,editable:r,width:null==(m=A.current)?void 0:m.offsetWidth,positionFromTop:null==(f=A.current)?void 0:f.offsetTop,className:"entity-description-container",editor:S,source:e,children:[l&&(0,w.jsx)(Wt,{}),(0,w.jsx)(Dt,{ref:v,source:e,autoFocus:!1,readOnly:!r,showToolbar:y,isOffline:i,initialValue:y?k:_,modelDetails:c,onChange:Z,context:"wysiwyg",enableAutoSaveOnBlur:r,inputFormat:"markdown",onEditorHeightChange:N,updateMediaUploadStatus:R,showEditorToggle:!p&&y,isEnvironmentResolutionEnabled:!0,isBigFontSize:g,placeholder:r?null!=a?a:`Add ${o?o+" ":""}description`:`This ${o||"item"} doesn't have a description.`})]})})},Vt=(0,n.memo)($t);var Ut=r(21466);const Bt=a()(s.Z).withConfig({displayName:"folder-overview__Container",componentId:"sc-f5u4xx-0"})(["overflow-y:auto;padding-top:var(--spacing-xxxl);padding-left:var(--spacing-l);height:100%;"]),Ht=a()(Nt.Z).withConfig({displayName:"folder-overview__ParentResponsiveContainer",componentId:"sc-f5u4xx-1"})(["width:100%;height:100%;"]),Kt=a()(Nt.Z).withConfig({displayName:"folder-overview__DocumentationResponsiveContainer",componentId:"sc-f5u4xx-2"})(["font-size:var(--text-size-m);line-height:var(--line-height-m);grid-template-rows:1fr auto;box-sizing:border-box;position:relative;row-gap:12px;height:100%;min-height:unset;padding-bottom:var(--spacing-zero);overflow:visible;.description-preview{overflow:auto;height:fit-content;max-height:100%;flex:1;&__markdown{word-break:break-word;}}.entity-description-container{width:100%;margin-bottom:var(--spacing-zero);& .mimir{.toolbar__anchor{top:-48px;.toolbar__wrapper{padding-right:var(--spacing-zero);}}}}"]),Jt=a()(s.Z).withConfig({displayName:"folder-overview__FolderDescriptionEditorContainer",componentId:"sc-f5u4xx-3"})(["overflow:visible;"]),Qt=(0,m.observer)((function(){const{canEdit:e}=it(),{mutate:t}=rt(),[r,i]=(()=>{const e=Be();return[e.metadata.description,e.setDescription]})(),[o]=Ke(),a=null==o?void 0:o.collection,{data:s}=(0,g.useActiveVariables)(),[c,l]=(0,n.useState)(r);return(0,n.useMemo)((()=>{const e=(0,Oe.v4)();Ut.VSCodeCommunicationsService.postMessageToExtension({type:"RESOLVE_VARIABLES",payload:{objectToResolve:{description:JSON.parse(JSON.stringify(r))},variables:s,id:e}}),Ut.VSCodeCommunicationsService.subscribe("RESOLVED_VARIABLES",(t=>{if(!t)return;const{id:r,resolvedObject:n}=t;r===e&&n&&l(n.description)}))}),[r,s]),(0,w.jsx)(Bt,{children:(0,w.jsx)(Ht,{type:"row",maxWidth:"container-width-medium",overflow:"unset",children:(0,w.jsx)(Kt,{type:"column",span:8,mobile:12,minHeight:"100%",children:(0,w.jsx)(Jt,{direction:"column","data-testid":"folder-description-editor-container",children:(0,w.jsx)(Vt,{onSave:e=>{i(e),t()},entityType:"folder",editable:e,entityDescription:r,resolvedEntityDescription:null!=c?c:"",source:"folder-overview",isEntityLoading:!1,minimumEditorHeight:120,isOffline:!1,modelDetails:{model:"collection",modelId:a},updateParentAboutContainerDimension:()=>{},placeholder:"Make things easier for your teammates with a complete folder description."})})})})})})),Gt=a()(Ye.PaneContent).withConfig({displayName:"folder-editor__StyledPaneContent",componentId:"sc-1665nxg-0"})(["box-sizing:border-box;width:100%;height:100%;overflow:hidden;"]),Yt=a()(vt.Z).withConfig({displayName:"folder-editor__StyledTabHeaders",componentId:"sc-1665nxg-1"})(["box-sizing:border-box;padding:var(--spacing-zero) var(--spacing-s);width:100%;"]),Xt=a()(vt.Z).withConfig({displayName:"folder-editor__StyledTabs",componentId:"sc-1665nxg-2"})(["box-sizing:border-box;padding:var(--spacing-zero) var(--spacing-s);&,> div,> div > div{flex:1;display:flex;flex-direction:column;overflow:hidden;}"]),er=a().div.withConfig({displayName:"folder-editor__StyledDiv",componentId:"sc-1665nxg-3"})(["width:100%;height:100%;"]),tr=()=>(0,w.jsx)(Ye.PaneHeader,{defaultLayout:"horizontal",horizontalComponent:null,width:{default:400,collapsed:33,uncollapsed:400,min:300,resizableByDefault:!0},verticalComponent:(0,w.jsx)(Ye.PaneLabel,{layout:"vertical",label:"Folder Editor",arrowDirection:"right"})}),rr=a()(s.Z).withConfig({displayName:"folder-editor__TabHeadersWrapper",componentId:"sc-1665nxg-4"})(["padding-inline-end:var(--spacing-l);"]),nr=()=>{const[e,t]=(0,n.useState)(0),[r,i]=(0,n.useState)(0),o=(0,n.useRef)(null);return(0,n.useEffect)((()=>{const e=()=>{o.current&&i(o.current.offsetWidth)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,w.jsxs)(er,{ref:o,children:[(0,w.jsx)(ir,{switchTab:t}),(0,w.jsx)(Gt,{children:(0,w.jsx)(or,{activeTabIndex:e,containerWidth:r})})]})},ir=e=>{const[t,r]=i().useState(0);return(0,w.jsx)(rr,{children:(0,w.jsx)(Yt,{activeTabIndex:t,onChange:function(t){r(t),e.switchTab(t)},type:"primary",incrementallyCreateTabs:!0,destroyInactiveTabs:!0,"data-testid":"folder-tabs-panel",children:(0,w.jsxs)(bt.Z,{children:[(0,w.jsx)(yt.Z,{label:"Overview"}),(0,w.jsx)(yt.Z,{label:(0,w.jsx)(Lt,{})}),(0,w.jsx)(yt.Z,{label:(0,w.jsx)(C,{})})]})})})},or=e=>(0,w.jsx)(Xt,{activeTabIndex:e.activeTabIndex,incrementallyCreateTabs:!0,destroyInactiveTabs:!0,children:(0,w.jsxs)(xt.Z,{children:[(0,w.jsx)(kt.Z,{children:(0,w.jsx)(Qt,{})}),(0,w.jsx)(kt.Z,{children:(0,w.jsx)(At,{})}),(0,w.jsx)(kt.Z,{children:(0,w.jsx)(Ze,{isScriptWidthNarrow:e.containerWidth<800})})]})}),ar=({children:e})=>{const t=(0,H.useActiveWorkspaceId)(),{folderId:r}=(0,f.useParams)(),n=new g.VariablesContextStore({collectionFetchOptions:(0,Fe.folderFindOneSelectCollectionQuery)({folderId:r})},{workspaceId:t});return(0,w.jsx)(g.VariablesContextProvider,{store:n,children:e})};var sr=r(49437),cr=r(80047);const lr=a()(s.Z).withConfig({displayName:"coming-soon__ComingSoonWrapper",componentId:"sc-o5w72p-0"})(["overflow:hidden;width:100%;"]);function dr({description:e}){return(0,w.jsx)(lr,{direction:"column",height:"100%",justifyContent:"center",alignItems:"center",children:(0,w.jsx)(sr.Z,{title:"Coming Soon",description:e,children:(0,w.jsx)(cr.Z,{name:"illustration-no-custom-domain"})})})}const ur=a()(s.Z).withConfig({displayName:"workbench-wrapper__FolderWorkbenchContainer",componentId:"sc-qn4r20-0"})(["height:var(--wp-workbench-height);width:100vw;min-width:650px;max-width:100%;background-color:var(--background-color-primary);color:var(--content-color-primary);overflow:hidden;"]),pr=(0,m.observer)((({children:e})=>{var t,r;const{isLoading:n,error:i}=(()=>{const e=Be();return{isLoading:e.isLoading,error:e.error}})(),[o]=Ke(),{folderId:a}=(0,f.useParams)();if((0,Fe.useCollectionSubscription)({collectionId:(null==o?void 0:o.collection)||"",workspaceId:(0,H.useActiveWorkspaceId)(),subscribingEntity:{id:null!=(t=null!=(r=null==o?void 0:o.id)?r:a)?t:"",type:"folder"}}),!n&&i)throw i;return(0,w.jsx)(ur,{direction:"column",children:n?(0,w.jsx)(l.Z,{size:"large",description:"Loading Folder"}):e})})),hr=a()(s.Z).withConfig({displayName:"folder-workbench__PaneWrapper",componentId:"sc-1cdbg0l-0"})(["flex:1;overflow:hidden;min-width:650px;max-width:100%;"]),gr=()=>Fe.ENABLE_COLLECTIONS?(0,w.jsx)(Ue,{children:(0,w.jsx)(ar,{children:(0,w.jsx)(c.VW,{children:(0,w.jsx)(Ye.Toast.Ui.ToastEventEmitter,{children:(0,w.jsxs)(pr,{children:[(0,w.jsx)(ft,{}),(0,w.jsxs)(hr,{direction:"column",children:[(0,w.jsx)(tr,{}),(0,w.jsx)(nr,{})]})]})})})})}):(0,w.jsx)(dr,{description:"Folder coming soon"})}}]);
//# sourceMappingURL=5736.fbadd241f2055da9.js.map