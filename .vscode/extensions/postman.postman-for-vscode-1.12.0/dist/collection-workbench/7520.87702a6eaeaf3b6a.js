"use strict";(self.webpackChunkcollection_workbench=self.webpackChunkcollection_workbench||[]).push([[7520],{17520:(e,t,n)=>{n.d(t,{Z:()=>ni});var i=n(40540),o=n.n(i),r=n(59530),a=n.n(r),s=n(58560),c=n(69019),l=n(35736),d=n(82196),u=n(64495),p=n(80429),h=n(26246),m=n(98276),g=n(60607),v=n(98283),f=n(78476);const b="New Collection";var y=n(50297);function x(){const e=He();return[e.preRequestStore.content,e.setPreRequestScript]}function k(){const e=He();return[e.testScriptStore.content,e.setTests]}var w=n(52322);const j=a().div.withConfig({displayName:"indicator-dot__Dot",componentId:"sc-2j0bxu-0"})(["display:inline-flex;width:calc(0.5 * var(--spacing-m));height:calc(0.5 * var(--spacing-m));margin-left:var(--spacing-xs);border-radius:calc(0.5 * var(--spacing-m));background-color:var(--base-color-success);&.error{background-color:var(--base-color-error);}"]),C=({isError:e=!1})=>(0,w.jsx)(j,{"aria-label":e?"tab with errors":"tab with active values",className:e?"error":"","data-testid":"tab-indicator-dot"}),S=(0,y.observer)((()=>{const[e]=x(),[t]=k(),n=!(!t&&!e);return(0,w.jsxs)(s.Z,{alignItems:"center",children:["Scripts",n&&(0,w.jsx)(C,{})]})})),I="prerequest";var _=n(63622),E=n(20856),P=n(39245);const T=a().div.withConfig({displayName:"script-tile__Indicator",componentId:"sc-1qqijps-0"})(["width:4px;height:4px;position:absolute;right:6px;border-radius:6px;background-color:",";"],(({hasError:e})=>e?"var(--base-color-error)":"var(--content-color-tertiary)")),L=a().div.withConfig({displayName:"script-tile__ScriptItemContainer",componentId:"sc-1qqijps-1"})(["display:flex;flex-direction:row;position:relative;align-items:center;box-sizing:border-box;cursor:pointer;padding:var(--spacing-s) var(--spacing-s) var(--spacing-s) var(--spacing-l);color:var( "," );background-color:var( "," );"],(({isActive:e})=>e?"--content-color-primary":"--content-color-secondary"),(({isActive:e})=>e?"--background-color-tertiary":"--background-color-primary")),A=a()(_.ZP).withConfig({displayName:"script-tile__ScriptLabel",componentId:"sc-1qqijps-2"})(["user-select:none;"]),N=a().div.withConfig({displayName:"script-tile__StyledContainer",componentId:"sc-1qqijps-3"})(["margin:var(--spacing-xs);"]),R=({script:e,setActiveScriptKey:t,activeScriptKey:n})=>(0,w.jsx)(E.ZP,{placement:"bottom-start",maxWidth:240,position:"bottom-start",triggerEvent:"mouseenter",delay:1e3,xOffset:60,trigger:(0,w.jsxs)(L,{onClick:()=>t(e.key),isActive:e.key===n,"data-testid":`request-script-tile-${e.key}`,children:[(0,w.jsx)(s.Z,{grow:1,children:(0,w.jsx)(A,{type:"body-medium",children:e.label})}),e.hasValue&&(0,w.jsx)(T,{})]}),children:(0,w.jsxs)(N,{children:[(0,w.jsx)(_.ZP,{children:e.tooltipText}),(0,w.jsx)("br",{}),(0,w.jsx)(P.Link,{to:e.tooltipLearnMoreLink,target:"_blank",children:(0,w.jsx)(_.ZP,{type:"link-default",isExternal:!0,children:"Learn more"})})]})});var Z=n(38053),z=n(49709),D=n.n(z),V=n(3341),O=n(3071);const q=a()(s.Z).withConfig({displayName:"right-scripts-panel__LeftSection",componentId:"sc-1ieqaui-0"})(["flex:1;"]),M=a().div.withConfig({displayName:"right-scripts-panel__SectionBody",componentId:"sc-1ieqaui-1"})(["flex:1;overflow:hidden;height:100%;margin-top:var(--spacing-l);margin-right:calc(-1 * var(--spacing-xxl));"]);function F(e){const[t,n]=(0,i.useState)(!0);return(0,w.jsxs)(s.Z,{height:"100%",children:[t&&(0,w.jsxs)(q,{direction:"column",children:[(0,w.jsx)("div",{children:e.header}),(0,w.jsx)(M,{children:e.children})]}),(0,w.jsx)("div",{children:(0,w.jsx)(p.Z,{onClick:()=>n((e=>!e)),type:"tertiary",icon:t?(0,w.jsx)(V.Z,{}):(0,w.jsx)(O.Z,{})})})]})}const W=a().h5.withConfig({displayName:"snippet-layout-components__SnippetTitle",componentId:"sc-2qksja-0"})(["flex:0;margin:0;margin-bottom:var(--spacing-xs);font-weight:var(--text-weight-bold);word-break:normal;font-size:var(--text-size-m);line-height:1.4;color:var(--content-color-secondary);"]),$=a().ul.withConfig({displayName:"snippet-layout-components__SnippetList",componentId:"sc-2qksja-1"})(["position:relative;z-index:1;overflow:auto;height:calc(100% - var(--spacing-l));flex:1;margin:0;padding:0;padding-right:var(--spacing-l);color:var(--content-color-link);box-sizing:border-box;font-family:var(--text-family-default);"]),U=a().li.withConfig({displayName:"snippet-layout-components__SnippetListItem",componentId:"sc-2qksja-2"})(["list-style:none;user-select:none;cursor:pointer;padding:var(--spacing-s) var(--spacing-zero);"]);var H=n(97550),B=n(10099),K=n(56880),J=n(56415),Q=n(52385);const G=a()(s.Z).withConfig({displayName:"package-list__DropDownList",componentId:"sc-183bafn-0"})(["max-height:200px;overflow-y:auto;scrollbar-width:none;-ms-overflow-style:none;&::-webkit-scrollbar{display:none;}"]),Y=a().div.withConfig({displayName:"package-list__DropDownListItem",componentId:"sc-183bafn-1"})(["display:flex;align-items:center;padding-right:var(--spacing-xs);border-radius:var(--border-radius-default);&:hover{background:var(--highlight-background-color-primary);cursor:pointer;}",""],(({disabled:e})=>e&&"\n    &:hover {\n      background: var(--background-color-primary);\n      cursor: not-allowed;\n    }\n  ")),X=a().div.withConfig({displayName:"package-list__DropDownEmptyState",componentId:"sc-183bafn-2"})(["padding:var(--spacing-xs) var(--spacing-m);"]),ee=a()(s.Z).withConfig({displayName:"package-list__IconContainer",componentId:"sc-183bafn-3"})(["height:28px;width:28px;"]),te=a().div.withConfig({displayName:"package-list__CustomMenuError",componentId:"sc-183bafn-4"})(["display:flex;padding:var(--spacing-xs) var(--spacing-s);"]),ne=a()(s.Z).withConfig({displayName:"package-list__CustomMenuLoader",componentId:"sc-183bafn-5"})(["height:120px;"]),ie=({packages:e,parsedPackagesId:t,searchTerm:n,isLoadingPackages:i,isError:o,refetch:r,handleAddPackages:a})=>{if(i)return(0,w.jsx)(ne,{justifyContent:"center",alignItems:"center",children:(0,w.jsx)(l.Z,{description:"Loading packages"})});if(o)return(0,w.jsx)(te,{children:(0,w.jsxs)(_.ZP,{children:["Error loading packages",(0,w.jsx)("span",{style:{marginLeft:"var(--spacing-xs)"},children:(0,w.jsx)(p.Z,{type:"monochrome-plain",text:"retry.",onClick:r})})]})});if(!e||0===e.length)return(0,w.jsx)(X,{children:(0,w.jsx)(_.ZP,{color:"content-color-tertiary",children:"No packages found."})});const s=(null==e?void 0:e.filter((e=>{var t;return!n||(null==(t=e.name)?void 0:t.toLowerCase().includes(n.toLowerCase()))})))||[],c=[],d=[];for(const e of s)t.includes(e.id)?c.push(e):d.push(e);return 0===c.length&&0===d.length?(0,w.jsx)(X,{children:(0,w.jsx)(_.ZP,{color:"content-color-tertiary",children:"No packages found."})}):(0,w.jsxs)(G,{direction:"column",children:[c.map((({id:e,name:t})=>(0,w.jsxs)(Y,{disabled:!0,"data-testid":"package-select-dropdown-item",children:[(0,w.jsx)(ee,{alignItems:"center",justifyContent:"center",children:(0,w.jsx)(Q.Z,{color:"content-color-tertiary"})}),(0,w.jsx)(_.ZP,{color:"content-color-tertiary",isTruncated:!0,tooltip:t,children:t})]},e))),d.map((({id:e,name:t,globalName:n})=>(0,w.jsxs)(Y,{"data-testid":"package-select-dropdown-item",onClick:()=>{K.AnalyticsService.addEventV2({category:"package_library",action:"use_existing_package",entityType:"package",variantId:"ide"}),a(t,n)},children:[(0,w.jsx)(ee,{alignItems:"center",justifyContent:"center"}),(0,w.jsx)(_.ZP,{isTruncated:!0,tooltip:t,children:t})]},e)))]})},oe=a()(E.ZP).withConfig({displayName:"package-select-dropdown__CustomDropDownWrapper",componentId:"sc-1iwxysm-0"})(["width:",";transform:translate(var(--border-width-default));background:var(--background-color-primary);border-radius:var(--border-radius-default);border:solid var(--border-width-default) var(--border-color-strong);.tippy-content{background:var(--background-color-primary);border-radius:var(--border-radius-s);}"],(e=>e.popoverWidth||"120px")),re=a()(s.Z).withConfig({displayName:"package-select-dropdown__CustomDropDownTrigger",componentId:"sc-1iwxysm-1"})(["background:var(--background-color-primary);border:solid var(--border-width-default) var(--content-color-tertiary);border-radius:var(--border-radius-default);padding:var(--spacing-xs) var(--spacing-s);padding-right:0;height:32px;margin-right:1px;margin-left:1px;width:248px;&:focus-within{box-shadow:0 0 0 1px var(--input-border-color-focus);}"]),ae=a().input.withConfig({displayName:"package-select-dropdown__CustomDropDownInput",componentId:"sc-1iwxysm-2"})(["width:100%;background:var(--background-color-primary);border:none;color:var(--content-color-primary);&::placeholder{color:var(--content-color-tertiary);}"]),se=a().div.withConfig({displayName:"package-select-dropdown__StyledInputContainer",componentId:"sc-1iwxysm-3"})(["display:flex;flex-grow:1;"]),ce=a().div.withConfig({displayName:"package-select-dropdown__StyledIconContainer",componentId:"sc-1iwxysm-4"})(["width:var(--size-m);height:var(--size-m);display:flex;align-items:center;justify-content:center;cursor:pointer;"]),le=({parsedPackagesId:e,handleAddPackages:t})=>{const[n,o]=(0,i.useState)(!1),[r,a]=(0,i.useState)(""),{data:s,isLoading:c,isError:l,refetch:d}=(0,Z.usePackagesWithGlobalName)(),u=(0,i.useRef)(null),p=(0,i.useRef)(null),h=(0,i.useRef)(null);return(0,i.useLayoutEffect)((()=>{let e;const t=()=>{if(u.current){const e=u.current.getBoundingClientRect();h.current&&(e.top!==h.current.top||e.left!==h.current.left)&&o(!1),h.current=e}e=requestAnimationFrame(t)};return t(),()=>{cancelAnimationFrame(e)}}),[]),(0,w.jsx)(oe,{isOpen:n,onClickOutside:()=>o(!1),popoverWidth:null!=u&&u.current?`${u.current.offsetWidth}px`:null,trigger:(0,w.jsxs)(re,{justifyContent:"space-between",alignItems:"center",ref:u,"data-testid":"package-select-dropdown-trigger",children:[(0,w.jsx)(se,{onClick:()=>{K.AnalyticsService.addEventV2({category:"package_library",action:"find_and_use_pkgs",variantId:"ide"}),o(!0)},children:(0,w.jsx)(ae,{value:r,onChange:e=>(e=>{a(e)})(e.target.value),placeholder:"Find & use packages",ref:p})}),(0,w.jsx)(ce,{onClick:()=>{var e;o(!n),null==(e=p.current)||e.focus()},children:(0,w.jsx)(J.Z,{})})]}),children:(0,w.jsx)(ie,{packages:s||[],parsedPackagesId:e,searchTerm:r,isLoadingPackages:c,isError:l,refetch:d,handleAddPackages:t})})},de=({packages:e,handleAddPackages:t})=>{const n=(0,B.useActiveWorkspaceId)(),i=Object.values(e).map((e=>e.id));return(0,w.jsxs)(s.Z,{direction:"column",gap:"spacing-s",children:[(0,w.jsx)(W,{children:"Packages"}),(0,w.jsx)(le,{parsedPackagesId:i,handleAddPackages:t}),(0,w.jsx)("div",{onClick:()=>{K.AnalyticsService.addEventV2({category:"package_library",action:"open_package_library",variantId:"ide"})},children:(0,w.jsx)(P.Link,{to:`/workspace/${n}/package-library`,customNavEvent:"VIEW_COLLECTION_FOLDER_REQUEST",children:(0,w.jsxs)(s.Z,{alignItems:"center",gap:"spacing-xs",children:[(0,w.jsx)(_.ZP,{type:"link-default",children:"Open package library"}),(0,w.jsx)(H.Z,{color:"content-color-link"})]})})})]})},ue=a().div.withConfig({displayName:"divider__Divider",componentId:"sc-1u2wnzf-0"})(["height:1px;background-color:var(--border-color-default);width:100%;margin-top:var(--spacing-s);margin-bottom:var(--spacing-s);"]),pe=D().getExamples("prerequest");function he({onSelect:e,packages:t,handleAddPackages:n,isPackageLibraryEnabled:i}){return(0,w.jsxs)(F,{children:[i&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(de,{packages:t,handleAddPackages:n}),(0,w.jsx)(ue,{})]}),(0,w.jsxs)(s.Z,{direction:"column",height:"100%",children:[(0,w.jsx)(W,{children:"Snippets"}),(0,w.jsx)($,{children:pe.map(((t,n)=>(0,w.jsx)(U,{"data-id":n,title:t.description,onClick:()=>null==e?void 0:e(t.code),children:t.name},n)))})]})]})}const me=a()(s.Z).withConfig({displayName:"scripts-panel-layout__FullHeightContainer",componentId:"sc-1xbi5ka-0"})(["height:calc(100% - var(--spacing-s));"]),ge=a().div.withConfig({displayName:"scripts-panel-layout__LeftPanel",componentId:"sc-1xbi5ka-1"})(["flex:1 1 70%;width:calc(100% - ","px - var(--text-size-m));"],250),ve=a().div.withConfig({displayName:"scripts-panel-layout__RightPanel",componentId:"sc-1xbi5ka-2"})(["flex:0 0 auto;max-width:","px;padding-left:var(--spacing-m);font-size:var(--text-size-s);"],250);function fe(e){return(0,w.jsx)(s.Z,{direction:"column",height:"100%",width:"100%",grow:1,children:(0,w.jsxs)(me,{children:[(0,w.jsx)(ge,{"data-testid":"script-left-panel",children:e.leftPanel}),(0,w.jsx)(ve,{"data-testid":"script-right-panel",children:e.rightPanel})]})})}var be=n(34583),ye=n(97201);const xe=async(e,t,n)=>{const i=`const ${(0,be.camelCase)(e)} = pm.require('${t}');\n`;n.executeEdits("execute-edits",[{range:{startLineNumber:1,startColumn:1,endLineNumber:1,endColumn:1},text:i,forceMoveMarkers:!0}]);const o={lineNumber:1,column:i.length+1};n.setPosition(o),n.pushUndoStop()};var ke=n(1590);const we=(0,i.lazy)((0,ke.loadRemoteModule)("code-editor/CodeEditor")),je=o().forwardRef(((e,t)=>(0,w.jsx)(i.Suspense,{fallback:(0,w.jsx)(l.Z,{}),children:(0,w.jsx)(we,Object.assign({},e,{ref:t}))}))),Ce={"pre-script":async()=>(await n.e(1394).then(n.t.bind(n,11394,17))).default,"tests-script":async()=>(await n.e(6773).then(n.t.bind(n,16773,17))).default};const Se=e=>e.charAt(0).toUpperCase()+e.slice(1),Ie=e=>"string"==typeof e?e:"object"==typeof e?JSON.stringify(e):String(e),_e=["jsLib","node","postman-collection","chai"],Ee=(0,i.forwardRef)((({content:e,onChange:t,onSetPackages:o,isPackagesEnabled:r,type:a="pre-script"},s)=>{const[c,l]=(0,i.useState)([]),[d,u]=(0,i.useState)(null),[p,h]=(0,i.useState)([]),g=(0,i.useRef)(null),{data:v,globalNameToIdMap:f}=(0,Z.usePackagesWithGlobalName)(),b=(()=>{const{data:e}=(0,m.useActiveAndDynamicVariables)();return(0,i.useCallback)(((t,n)=>{const i=new RegExp(/pm.(environment|globals|collectionVariables|variables).(((get|set|unset|has)\(('|").*))$/),o=t.getWordBeforePosition(n);let r=t.getLineContent(n.lineNumber);r&&(r=r.slice(0,Math.max(0,n.column-1)));let a=[];const s=i.exec(r);if(!s||s.length<6)return[];const c=s[1],l=e;let d=[];if(!l)return[];const u={globals:"globals",environment:"environment",collectionVariables:"collection"};if("variables"===c)d=l.filter((e=>Ie(e.key).toLowerCase().includes(o.word.toLowerCase())));else if(u[c]){const e=u[c];d=l.filter((t=>t.scope===e&&"dynamic"!==t.type&&Ie(t.key).toLowerCase().includes(o.word.toLowerCase())))}return p=d,h={startLineNumber:n.lineNumber,endLineNumber:n.lineNumber,startColumn:o.startColumn,endColumn:o.endColumn},a=p.map((e=>{let t={environment:"a",collection:"b",global:"c"}[e.scope]||"y";return"dynamic"===e.type?(t="z",{label:e.key,detail:`Details: ${Ie(e.description)}`,documentation:`Scope: ${Se(e.scope)}\n\n`,insertText:e.key,range:h,sortText:`${t}-${e.key}`}):{label:e.key,detail:`Current: ${e.sessionValue}`,documentation:`Initial: ${Ie(e.value)} \nScope: ${Se(e.scope)}\n\n`,insertText:e.key,range:h,sortText:`${t}-${e.key}`}})),a;var p,h}),[e])})(),y=async e=>{try{const t=Object.entries(e).filter((([e])=>f.get(e))).map((([e,{id:t}])=>(async(e,t)=>{if(!g.current)throw new Error("Worker pool not initialized");const n=v.find((t=>t.id===e)),i=null==n?void 0:n.indexScript.id;if(!i)throw new Error(`Script ID not found for package: ${t}`);const o=await(async(e,t)=>{try{return await ye.cacheClient.fetchQuery((0,Z.getScriptQuery)(e,t))}catch(e){throw console.error("Error fetching script content:",e),e}})(e,i),r=await g.current.execute({jsCode:o.contents.src,packageName:n.name});return{id:`${t}-${new Date(o.lastRetrievedAt).getTime()}`,content:r.result||""}})(t,e))),n=((e,t)=>{if(!d)return e;let n="";const i=new Set(Object.values(t).map((({id:e})=>e)));return n=`\n      ${n}\n      declare interface Postman { ${v.filter((e=>i.has(e.id))).map((e=>`require(name: '${null==e?void 0:e.globalName}'): typeof import('${null==e?void 0:e.name}');`)).join("\n")} }\n    `,[{id:`${d.id}-${Math.random()}`,content:`${d.content}\n      ${n}\n      `},...e]})((await Promise.all(t)).filter((e=>e.content)),e);h(n)}catch(e){console.error("Error adding package libraries:",e)}},x=(0,be.debounce)((async e=>{const{parsedRequireStatements:t,validationErrors:i,parseError:r}=await async function(e){let t;const i=await async function(){return n.e(8511).then(n.t.bind(n,78511,23))}(),o=[],r=[];try{t=i.createSourceFile("code.js",e,i.ScriptTarget.Latest)}catch(e){return{parseError:!0}}return function e(t){if(i.isCallExpression(t)){const{expression:e}=t;if(i.isPropertyAccessExpression(e)&&i.isIdentifier(e.expression)&&"pm"===e.expression.text&&i.isIdentifier(e.name)&&"require"===e.name.text){const e=t.arguments[0];if(e&&i.isStringLiteral(e))o.push(e.text);else{const n=e&&i.getLineAndCharacterOfPosition(t.getSourceFile(),e.pos);r.push({message:"pm.require accepts only string literal as argument",startLineNumber:null==n?void 0:n.line,endLineNumber:null==n?void 0:n.line,startColumn:(null==n?void 0:n.character)+1,endColumn:(null==n?void 0:n.character)+1,severity:3})}}}i.forEachChild(t,e)}(t),{parsedRequireStatements:o,validationErrors:r}}(e);if(r||!t)return;i&&l(i);const a={};for(const e of t){const t=f.get(e);t&&(a[e]={id:t})}o(a),y(a)}),1e3,{leading:!0});return(0,i.useEffect)((()=>(r&&((async()=>{try{const e=await(async()=>{const e=await fetch(`${window.BASE_URL_PREFIX}/http-workbench/script-parser-worker.js`),t=await e.blob(),n=URL.createObjectURL(t);return new Worker(n)})(),t=function(e,t,n){const i=[],o=[];let r;function a(){const t=e();return t.busy=!1,t.addEventListener("message",c),t.addEventListener("error",c),t}function s(){clearTimeout(r);const e=i.find((e=>!e.busy));if(e&&o.length>0){const t=o.shift();if(t){const{data:o,resolve:r,reject:a}=t;e.busy=!0,e.currentTask=o,e.postMessage(o),e.taskResolve=r,e.taskReject=a,e.taskTimeoutId=setTimeout((()=>{var t;(t=e).busy&&(t.taskTimeoutId=void 0,null==t.taskReject||t.taskReject(new Error(`Task execution timed out after ${n}ms`)),t.terminate(),function(e){const t=i.indexOf(e);-1!==t&&i.splice(t,1)}(t),s())}),n)}}else 0===o.length&&(r=setTimeout((()=>{l()}),n))}function c(e){const t=e.target;t.taskTimeoutId&&(clearTimeout(t.taskTimeoutId),t.taskTimeoutId=void 0),t.busy=!1,t.currentTask=void 0,"message"===e.type?null==t.taskResolve||t.taskResolve(e.data):null==t.taskReject||t.taskReject(e.message),t.taskResolve=void 0,t.taskReject=void 0,s()}function l(){for(const e of i)e.taskTimeoutId&&(clearTimeout(e.taskTimeoutId),e.taskTimeoutId=void 0),e.terminate();i.length=0}return{execute:function(e){return new Promise(((n,r)=>{o.push({data:e,resolve:n,reject:r}),function(){for(;i.length<t;)i.push(a())}(),s()}))},terminateWorkers:l}}((()=>e),3,1e4);g.current=t}catch(e){console.error("Failed to set up script parser worker pool:",e)}})(),(async e=>{try{const t={id:e,content:await Ce[e]()};return u(t),t}catch(e){return""}})(a)),()=>{var e;null==(e=g.current)||e.terminateWorkers()})),[r]),(0,w.jsx)(je,{ref:s,showNonPrintableCharacters:!0,fontSize:12,language:"javascript",codeCompletionProviders:[{provider:b}],wordWrap:!0,autoFormat:!0,value:e,onChange:e=>{t(e),r&&x(e)},typeDefinitionTypes:[..._e,...p],validationErrors:c})})),Pe=(0,y.observer)((function(){const e=(0,i.useRef)(null),[t,n]=x(),[o,r]=function(){const e=He();return[e.preRequestStore.packages,e.onPreRequestScriptPackageChange]}(),{isEnabled:a}=(0,Z.useIsPackageEnabled)(),s=(0,i.useCallback)((t=>{var n;null==(n=e.current)||n.insertTextBlock(t)}),[]);return(0,w.jsx)(fe,{leftPanel:(0,w.jsx)(Ee,{ref:e,content:t,onChange:n,onSetPackages:r,isPackagesEnabled:a,type:"pre-script"}),rightPanel:(0,w.jsx)(he,{onSelect:s,packages:o,handleAddPackages:(t,n)=>{var i;const o=null==(i=e.current)?void 0:i.editor;o&&xe(t,n,o)},isPackageLibraryEnabled:a})})})),Te=D().getExamples("test");function Le({onSelect:e,packages:t,handleAddPackages:n,isPackageLibraryEnabled:i}){return(0,w.jsxs)(F,{children:[i&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(de,{handleAddPackages:n,packages:t}),(0,w.jsx)(ue,{})]}),(0,w.jsxs)(s.Z,{direction:"column",height:"100%",children:[(0,w.jsx)(W,{children:"Snippets"}),(0,w.jsx)($,{children:Te.map(((t,n)=>(0,w.jsx)(U,{"data-id":n,title:t.description,onClick:()=>null==e?void 0:e(t.code),children:t.name},n)))})]})]})}const Ae=(0,y.observer)((function(){const e=(0,i.useRef)(null),[t,n]=k(),[o,r]=function(){const e=He();return[e.testScriptStore.packages,e.onTestScriptPackageChange]}(),{isEnabled:a}=(0,Z.useIsPackageEnabled)(),s=(0,i.useCallback)((t=>{var n;null==(n=e.current)||n.insertTextBlock(t)}),[]);return(0,w.jsx)(fe,{leftPanel:(0,w.jsx)(Ee,{ref:e,content:t,onChange:n,onSetPackages:r,isPackagesEnabled:a,type:"tests-script"}),rightPanel:(0,w.jsx)(Le,{onSelect:s,packages:o,handleAddPackages:(t,n)=>{var i;const o=null==(i=e.current)?void 0:i.editor;o&&xe(t,n,o)},isPackageLibraryEnabled:a})})})),Ne=a()(s.Z).withConfig({displayName:"scripts-panel__ScriptList",componentId:"sc-1xmbkuu-0"})(["width:",";border-right:var(--border-width-default) var(--border-style-solid) var(--border-color-default);"],(({isScriptWidthNarrow:e})=>e?"81px":"115px")),Re=a()(s.Z).withConfig({displayName:"scripts-panel__ScriptContainer",componentId:"sc-1xmbkuu-1"})(["flex:1 1 auto;min-width:0;"]),Ze=(0,y.observer)((({isScriptWidthNarrow:e})=>{const[t,n]=(0,i.useState)(I),[o]=x(),[r]=k(),a=[{key:I,label:e?"Pre-req":"Pre-request",hasValue:!!o,tooltipText:"Runs before each request is sent. Use it to create API workflows by configuring the requests dynamically.",tooltipLearnMoreLink:"https://go.pstmn.io/docs-prerequest-scripts"},{key:"postresponse",label:e?"Post-res":"Post-response",hasValue:!!r,tooltipText:"Runs after a response is received for each request. Use it to write tests.",tooltipLearnMoreLink:"https://go.pstmn.io/docs-test-scripts"}];return(0,w.jsxs)(s.Z,{width:"100%",height:"100%",padding:{paddingTop:"spacing-s"},children:[(0,w.jsx)(Ne,{isScriptWidthNarrow:e,direction:"column",children:a.map((e=>(0,w.jsx)(R,{script:e,setActiveScriptKey:n,activeScriptKey:t},e.key)))}),(0,w.jsx)(Re,{children:t===I?(0,w.jsx)(Pe,{}):(0,w.jsx)(Ae,{})})]})}));var ze=n(60398);class De{parsePayload(e){const t=null==e?void 0:e.find((e=>e.listen===this.type));return t?t.script.exec.join("\n"):""}parsePackages(e){var t,n;const i=null==e?void 0:e.find((e=>e.listen===this.type));return null!=(t=null==i||null==(n=i.script)?void 0:n.packages)?t:{}}constructor(e,t){this.type=void 0,this.content="",this.packages={},this.update=e=>{this.content=this.parsePayload(e),this.packages=this.parsePackages(e)},this.setContent=e=>{this.content=e},this.setPackages=e=>{this.packages=e},this.type=e,this.content=this.parsePayload(t),this.packages=this.parsePackages(t),(0,f.makeObservable)(this,{content:!0,packages:!0,setContent:f.action,setPackages:f.action})}getPayload(){return this.content?[{listen:this.type,script:{id:(0,ze.v4)(),exec:this.content.split("\n"),type:"text/javascript",packages:this.packages}}]:[]}}var Ve=n(53186),Oe=n(85692),qe=n(18767);function Me(e,t){var n,i,o,r;if(e===t)return!0;if(!e||!t)return!1;const a=(null==(n=e.find((e=>"test"===e.listen)))?void 0:n.script.exec)||[],s=(null==(i=t.find((e=>"test"===e.listen)))?void 0:i.script.exec)||[],c=(null==(o=e.find((e=>"prerequest"===e.listen)))?void 0:o.script.exec)||[],l=(null==(r=t.find((e=>"prerequest"===e.listen)))?void 0:r.script.exec)||[];return Array.isArray(a)&&Array.isArray(s)&&JSON.stringify(a)===JSON.stringify(s)&&Array.isArray(c)&&Array.isArray(l)&&JSON.stringify(c)===JSON.stringify(l)}const Fe=["activeAuthType"];class We{constructor({collectionId:e}){var t=this;this.collectionId=void 0,this.isLoading=!0,this.error=null,this.unsubscribeFromCollectionCache=void 0,this.unsubscribeFromVariableSessionUpdates=null,this.metadata={},this.preRequestScript="",this.tests="",this.initialValues=[],this.sessionValues=[],this.preRequestStore=new De("prerequest",[]),this.testScriptStore=new De("test",[]),this.collectionAuthState=Object.assign({activeAuthType:"noauth",type:"noauth"},qe.initialAuthState),this.collectionAuthSessionState=qe.defaultAuthSession,this.trackedState={},this.isConflicted=!1,this.isSaving=!1,this.permissions={},this.cachedCollectionItem=void 0,this.isDeleted=!1,this.startListeningToCollectionCache=()=>{const e=new ye.MultiCacheObserver(ye.cacheClient,[(0,Ve.collectionFindOneQuery)({collectionId:this.collectionId}),(0,Ve.collectionPermissionsQuery)({collectionId:this.collectionId})]);this.unsubscribeFromCollectionCache=e.subscribe((e=>{this.onCollectionCacheUpdate(e[0]),this.onCollectionPermissionsUpdate(e[1])}))},this.startListeningToSessionStorage=async function(){t.unsubscribeFromVariableSessionUpdates=(0,Oe.subscribeToSession)({model:"collection",modelId:t.collectionId},(e=>t.onVariableSessionStorageUpdate(e))),t.onVariableSessionStorageUpdate(await(0,Oe.getSession)({model:"collection",modelId:t.collectionId}))},this.setTrackedState=(e,t)=>{e&&(this.trackedState=Object.assign({},this.trackedState,{[e]:t}))},this.setIsDeleted=e=>{this.isDeleted=e},this.setMetadata=e=>{this.metadata=e},this.setDescription=e=>{(0,f.transaction)((()=>{this.metadata.description=e,this.setTrackedState("description",this.metadata.description)}))},this.setPreRequestScript=e=>{(0,f.transaction)((()=>{this.preRequestStore.setContent(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)}))},this.setTests=e=>{(0,f.transaction)((()=>{this.testScriptStore.setContent(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)}))},this.onPreRequestScriptPackageChange=e=>{this.preRequestStore.setPackages(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)},this.onTestScriptPackageChange=e=>{this.testScriptStore.setPackages(e);const t=[...this.preRequestStore.getPayload(),...this.testScriptStore.getPayload()];this.setTrackedState("events",t)},this.setCollectionAuthState=e=>{(0,f.transaction)((()=>{this.collectionAuthState=e;const{activeAuthType:t}=e,n=(0,v.Z)(e,Fe),i=Object.assign({},n,{type:t});this.setTrackedState("auth",i)}))},this.setCollectionAuthSessionState=e=>{this.collectionAuthSessionState=e},this.setVariables=e=>{const{initialValues:t,sessionValues:n}=(0,m.unZipVariables)(e);(0,f.transaction)((()=>{this.initialValues=t,this.sessionValues=n,this.setTrackedState("initialValues",t),this.setTrackedState("sessionValues",n)}))},this.setIsSaving=e=>{this.isSaving=e},this.onCollectionCacheUpdate=e=>{var t,n;const i=null==(t=e.data)?void 0:t.data,o=null==(n=e.data)?void 0:n.meta.forkedFrom;if(this.isLoading=!i&&!e.error,this.error=e.error,!i)return;const{incomingChanges:r,isConflicted:a}=function(e,t,n,i){const o={};let r=!1;if(!t)return{incomingChanges:e,isConflicted:r};for(const i of["name","auth","variables","events"])switch(i){case"events":Me(e[i],t[i])||(n[i]?r=!0:o[i]=e[i]);break;case"auth":case"name":e[i]!==t[i]&&i in n?r=!0:e[i]!==t[i]&&(o[i]=e[i]);break;case"variables":e[i]!==t.initialValues&&"initialValues"in n?r=!0:e[i]!==t.initialValues&&(o[i]=e[i])}return{incomingChanges:o,isConflicted:r}}(i,this.cachedCollectionItem,this.trackedState);this.isDirty&&a&&(0,f.runInAction)((()=>{this.isConflicted=!0})),r&&Object.keys(r).length>0&&(0,f.runInAction)((()=>{var e,t,n,r,a,s;this.collectionAuthState=i.auth&&(s=null!=(e=this.trackedState.auth)?e:i.auth)?Object.assign({},qe.initialAuthState,s,{activeAuthType:s.type||"noauth"}):Object.assign({activeAuthType:"noauth",type:"noauth"},qe.initialAuthState),this.initialValues=null!=(t=null!=(n=this.trackedState.initialValues)?n:i.variables)?t:[],this.preRequestStore.update(null!=(r=this.trackedState.events)?r:i.events),this.testScriptStore.update(null!=(a=this.trackedState.events)?a:i.events),this.cachedCollectionItem=i,this.metadata={id:i.id,name:i.name,description:i.description,createdAt:i.createdAt,forkInfo:o?Object.assign({label:null==o?void 0:o.forkName},o):this.metadata.forkInfo,owner:i.owner}}))},this.onCollectionPermissionsUpdate=e=>{const t=e.data;t&&(0,f.runInAction)((()=>{this.permissions=t}))},this.collectionId=e,(0,f.makeObservable)(this,{isLoading:!0,error:!0,breadcrumbs:f.computed,metadata:f.observable.ref,name:f.computed,metaInfo:f.computed,setMetadata:f.action,preRequestScript:!0,setPreRequestScript:f.action,collectionAuthState:!0,setCollectionAuthState:f.action,collectionAuthSessionState:!0,setCollectionAuthSessionState:f.action,tests:!0,setTests:f.action,variables:f.computed,initialValues:!0,sessionValues:!0,setVariables:f.action,onCollectionCacheUpdate:f.action,isDirty:f.computed,trackedState:!0,setTrackedState:f.action,isConflicted:!0,setIsSaving:f.action,isSaving:!0,permissions:!0,isForked:f.computed,isDeleted:!0,setIsDeleted:f.action,onPreRequestScriptPackageChange:f.action,onTestScriptPackageChange:f.action}),this.startListeningToCollectionCache(),this.startListeningToSessionStorage()}async onVariableSessionStorageUpdate(e){e&&(0,f.runInAction)((()=>{var t;this.sessionValues=null!=(t=null==e?void 0:e.values)?t:[]}))}get isForked(){var e;return!(null==(e=this.metadata.forkInfo)||!e.label)}get isDirty(){return Object.keys(this.trackedState).length>0}get breadcrumbs(){return null!=(e=this.metadata)&&e.name?[{name:e.name,id:e.id}]:[{id:"DEFAULT",name:b}];var e}get name(){var e;return null!=(e=this.metadata.name)?e:b}get metaInfo(){var e,t;return{createdAt:null!=(e=null==(t=this.metadata)?void 0:t.createdAt)?e:null,id:this.collectionId}}get variables(){const{initialValues:e,sessionValues:t}=this;return(0,m.zipVariables)(e,t)}resetTrackedState(){(0,f.runInAction)((()=>{this.trackedState={},this.isConflicted=!1}))}rollbackUpdates(e,t){(0,f.runInAction)((()=>{this.trackedState=e,this.isConflicted=t}))}destroy(){var e,t;null==(e=this.unsubscribeFromCollectionCache)||e.call(this),null==(t=this.unsubscribeFromVariableSessionUpdates)||t.call(this),this.trackedState={}}}const $e=(0,i.createContext)({}),Ue=({children:e})=>{if(!(0,g.useInRouterContext)())throw new Error("CollectionEditorProvider must be used within a Router");const{collectionId:t}=(0,g.useParams)(),n=(0,i.useMemo)((()=>new We({collectionId:t})),[]);return(0,i.useEffect)((()=>()=>n.destroy()),[]),(0,w.jsx)($e.Provider,{value:n,children:e})},He=()=>{const e=o().useContext($e);if(!e)throw new Error("useCollectionEditorStore should be used within a CollectionEditorContext.Provider");return e},Be=()=>He().name,Ke=()=>{const e=He();return[e.metadata,e.setMetadata]};var Je=n(49886),Qe=n(24502);const Ge=()=>{const e=He();return{isDirty:e.isDirty,isSaving:e.isSaving,isConflicted:e.isConflicted}};var Ye=n(19578);const Xe=["collectionId","patch"],et=["sessionValues","initialValues"],tt=["mutate"],nt=(0,Ve.updateCollectionMutation)(),it=(e,t)=>Object.assign({},e,{values:e.values.map(((e,n)=>{var i;return null===e.value||void 0===e.value?Object.assign({},e,{value:null==(i=t[n])?void 0:i.value}):e}))}),ot=Object.assign({},nt,{mutationFn:async e=>{let{collectionId:t,patch:n}=e,i=(0,v.Z)(e,Xe);const{sessionValues:o,initialValues:r}=n,a=(0,v.Z)(n,et),[s]=await Promise.all([nt.mutationFn(Object.assign({collectionId:t},i,{patch:Object.assign({},a,{variables:r}),options:{avoidSession:!0}})),o&&(0,Oe.setSession)({model:"collection",modelId:t},it({values:o},null!=r?r:[]))]);return s}}),rt=()=>{const e=He(),t=(0,ye.useMutation)(ot),{mutate:n}=t,i=(0,v.Z)(t,tt);return Object.assign({mutate:t=>{const i=e.trackedState,o=e.isConflicted;return t&&(i.name=t),e.resetTrackedState(),e.setIsSaving(!0),n({collectionId:e.collectionId,patch:i},{onError:()=>{e.rollbackUpdates(i,o),Ye.Toast.getToasts().addToast({title:"Unable to save changes",description:"Could not save changes. Please try again.",status:"error"})},onSettled:()=>{e.setIsSaving(!1)}})}},i)},at=rt,st=new Set(["Alt","Meta","Control","Shift"]),ct=()=>{var e,t;const n=He();return 0===Object.keys(n.permissions).length?{canEdit:!0,canDelete:!0}:{canEdit:null==(e=n.permissions[Ve.CollectionPermissionNames.UPDATE_COLLECTION])?void 0:e.allowed,canDelete:null==(t=n.permissions[Ve.CollectionPermissionNames.DELETE_COLLECTION])?void 0:t.allowed}};var lt=n(37691);const dt=a().div.withConfig({displayName:"fork-label__ForkLabelWrapper",componentId:"sc-1m28191-0"})(["display:flex;align-items:center;overflow:hidden;"]),ut=a().p.withConfig({displayName:"fork-label__LabelContainer",componentId:"sc-1m28191-1"})(["display:inline-block;white-space:nowrap;overflow:hidden;margin-left:var(--spacing-xs);font-size:var(--text-size-s);font-weight:var(--text-weight-regular);text-overflow:ellipsis;color:var(--content-color-tertiary);"]),pt=({label:e})=>(0,w.jsxs)(dt,{children:[(0,w.jsx)(lt.Z,{color:"content-color-tertiary",size:"small"}),(0,w.jsx)(ut,{children:e})]});var ht=n(38394),mt=n(95617),gt=n(26663),vt=n.n(gt);const ft=({pathname:e})=>{const[t,n]=(0,i.useState)(!1),o=(0,i.useRef)(),r=(0,i.useCallback)((()=>{const t=vt().ARTEMIS_URL;navigator.clipboard.writeText(t+e).then((()=>{n(!0),null!=o&&o.current&&clearTimeout(o.current),o.current=setTimeout((()=>{n(!1)}),1500)}))}),[e,o]);return(0,w.jsx)(p.Z,{type:"tertiary",size:"small",className:"copy-link-btn",icon:t?(0,w.jsx)(ht.Z,{size:"small",color:"base-color-success"}):(0,w.jsx)(mt.Z,{size:"small"}),onClick:r,tooltip:"Copy link to collection"})},bt=()=>He().metaInfo;var yt=n(83354);const xt=(0,i.lazy)((0,ke.loadRemoteModule)("collection-runner/RunCollectionButton")),kt=a().div.withConfig({displayName:"collection-meta-header__CollectionMetaHeaderContainer",componentId:"sc-5l62ez-0"})(["display:flex;flex-direction:'row';justify-content:space-between;box-sizing:border-box;height:48px;padding:var(--spacing-s) var(--spacing-s);border-bottom:var(--border-width-default) var(--border-style-solid) var(--border-color-default);"]),wt=a().div.withConfig({displayName:"collection-meta-header__BreadcrumbContainer",componentId:"sc-5l62ez-1"})(["color:var(--content-color-primary);font-weight:var(--text-weight-medium);width:100%;nav{.copy-link-btn{display:none;}:hover{.copy-link-btn{display:inline-flex;}}}"]),jt=a()(s.Z).withConfig({displayName:"collection-meta-header__LeftSectionRow",componentId:"sc-5l62ez-2"})(["width:100%;padding:var(--spacing-xs);overflow:hidden;"]),Ct=(0,y.observer)((()=>{const e=He().breadcrumbs,t=Be(),{isDirty:n,isConflicted:o}=Ge(),{canEdit:r}=ct(),{mutate:a}=rt(),[c]=Ke(),{pathname:p}=(0,P.useLocation)(),h=(0,i.useRef)(null),{rename:m}=(0,P.useAdditionalRouteContext)();(0,i.useEffect)((()=>{var e;m&&(null==(e=h.current)||e.triggerRenameMode())}),[m]);const{setTabTitle:g}=(0,P.useTabTitleMeta)();(0,i.useEffect)((()=>{g(t,"collection",{isDirty:n,isConflicted:o})}),[t,n,o]);const v=null==c?void 0:c.forkInfo,f=e=>{e!==t&&a(e)};return null!=c&&c.name?(0,w.jsx)(jt,{direction:"row",shrink:"1",grow:"0",alignItems:"center",gap:"spacing-s",children:(0,w.jsx)(wt,{children:(0,w.jsx)(d.aG,{appendActions:(0,w.jsx)(ft,{pathname:p}),metaInfo:{custom:(0,w.jsxs)(s.Z,{alignItems:"center",gap:"spacing-s",children:[(null==v?void 0:v.label)&&(0,w.jsx)(pt,{label:v.label}),!r&&(0,w.jsx)(Je.Z,{title:"You do not have permissions to edit this collection"})]})},ref:h,children:e.map((e=>(0,w.jsx)(u.Z,{enableRename:r,renameInputConfig:{onSubmit:f,value:t},itemData:e,children:e.name},e.name)))})})}):(0,w.jsx)(l.Z,{})})),St=(0,y.observer)((()=>{const{isDirty:e,isSaving:t,isConflicted:n}=Ge(),{mutate:o}=rt(),{canEdit:r}=ct(),a=(0,B.useActiveWorkspaceId)(),{userCanRunCollection:c}=(0,Ve.useWorkspacePermissions)(a),d=r&&e,u=Be(),g=h.Modals.getModals(),v=bt(),f=async()=>{if(!r||!e)return;if(!n)return o();const t=await g.showWarningDialog({uid:"collections-workbench-tab-conflict-confirmation",subject:"DO YOU WANT TO SAVE?",message:`This tab ${u} has been modified from another tab. Saving these changes will overwrite this collection.`,options:[{title:"Cancel",isDefaultOnDismiss:!0},{title:"Save and overwrite",isPrimary:!0}]});return t&&"Save and overwrite"===t.title?o():void 0};return(({ctrlKey:e,shiftKey:t,altKey:n,keys:o,callback:r})=>{const a=(0,i.useRef)([]),s=(0,i.useRef)(!1),c=(0,i.useRef)(!1),l=(0,i.useRef)(!1),d=(0,i.useRef)(null),u=(0,i.useRef)(r);u.current=r,(0,i.useEffect)((()=>{const i=i=>{if((i.ctrlKey||i.metaKey)&&(s.current=!0),i.shiftKey&&(c.current=!0),i.altKey&&(l.current=!0),!st.has(i.key)&&Array.isArray(o)){const e=o.findIndex((e=>e.toLowerCase()===i.key.toLowerCase()));-1!==e&&(a.current[e]=i.key)}const r=!e||s.current,p=!t||c.current,h=!n||l.current;if(d.current=setTimeout((()=>{s.current=!1,c.current=!1,l.current=!1,a.current=[]}),2500),r&&p&&h){if(Array.isArray(o)&&((e,t)=>{let n=0;for(const o of e){var i;if(o.toLowerCase()!==(null==(i=t[n])?void 0:i.toLowerCase()))return!1;n++}return!0})(o,a.current))return u.current();if(o===i.key)return u.current()}};return window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i),d.current&&clearTimeout(d.current)}}),[e,t,n,o])})({ctrlKey:!0,keys:"s",callback:f}),(0,w.jsxs)(s.Z,{className:"request-meta-header-right-section",direction:"row",alignItems:"center",gap:"spacing-s",children:[(0,w.jsx)(i.Suspense,{fallback:(0,w.jsx)(l.Z,{}),children:(0,w.jsx)(xt,{isDisabled:!c,collectionId:v.id})}),(0,w.jsx)(p.Z,{type:"tertiary",text:t?"Saving...":"Save",isDisabled:!d||t,onClick:f,icon:(0,w.jsx)(Qe.Z,{})}),(0,w.jsx)(yt.ShareButton,{entityType:"collection",entityId:v.id,entityName:u}),(0,w.jsx)(m.ActiveEnvironmentSelector,{})]})})),It=()=>(0,w.jsxs)(kt,{children:[(0,w.jsx)(Ct,{}),(0,w.jsx)(St,{})]});var _t=n(15761),Et=n(27366),Pt=n(71132),Tt=n(27162),Lt=n(5246);const At=()=>{const e=He();return[e.variables,e.setVariables]},Nt=(0,y.observer)((()=>{const[e]=At();return(0,w.jsxs)(w.Fragment,{children:["Variables",e.length>0&&(0,w.jsx)(C,{})]})})),Rt=()=>{const e=He();return[e.collectionAuthState,e.setCollectionAuthState]},Zt=(0,y.observer)((()=>{const[e]=Rt();return(0,w.jsxs)(w.Fragment,{children:["Authorization",e.activeAuthType&&"noauth"!==e.activeAuthType&&(0,w.jsx)(C,{})]})}));var zt=n(71453);const Dt=a()(s.Z).withConfig({displayName:"collection-no-auth__NoAuthContainer",componentId:"sc-1ajyu6r-0"})(["width:100%;height:100%;align-items:center;justify-content:center;text-align:center;"]),Vt=a()(P.Link).withConfig({displayName:"collection-no-auth__AuthorizationLink",componentId:"sc-1ajyu6r-1"})(["display:inline-flex;align-items:center;text-decoration:underline;color:var(--content-color-secondary);"]),Ot=()=>(0,w.jsxs)(Vt,{type:"link-default",to:"https://go.pstmn.io/docs-auth",target:"_blank",rel:"noopener noreferer",children:["authorization",(0,w.jsx)(zt.Z,{})]}),qt=()=>(0,w.jsx)(Dt,{children:(0,w.jsxs)("div",{children:["This collection does not use any authorization. Learn more aboutÂ ",(0,w.jsx)(Ot,{})]})}),Mt=(0,y.observer)((function(){const[e,t]=Rt(),[n,o]=(()=>{const e=He(),[t]=Ke(),{value:n,setValue:o}=(0,qe.useAuthSessionSafe)({model:"collection",modelId:t.id});return(0,i.useEffect)((()=>{n&&e.setCollectionAuthSessionState(n)}),[n,e]),[e.collectionAuthSessionState,(t,n)=>{const i=Object.assign({},e.collectionAuthSessionState);i.oauth2||(i.oauth2=[]),i.oauth2=i.oauth2.filter((e=>"token_id"!==e.key)),i.oauth2.push({key:t,value:n}),o(i)}]})();return(0,w.jsx)(qe.AuthPanel,{authState:e,authSessionState:n,authDescriptions:{noauth:(0,w.jsx)(qt,{})},disabledAuthTypes:["inherit"],setAuthState:t,setAuthSessionState:o})}));var Ft=n(19956);const Wt=["entityType","isEditable","bleed","onChange","values"],$t=a().div.withConfig({displayName:"variable-editor__StyledVariablesEditor",componentId:"sc-bsbj66-0"})(["flex:1;display:flex;flex-direction:column;overflow:hidden;padding:0 var(--spacing-l);"]),Ut=function(e){const{entityType:t="collection",isEditable:n=!0,bleed:i=!1,onChange:o,values:r}=e,a=(0,v.Z)(e,Wt);return(0,w.jsx)($t,{children:(0,w.jsx)(Ft.KeyValueEditor,Object.assign({enableScroll:!0,tableName:`Variables Editor - ${t}`,entityType:t,keyHeading:"Variable",valueHeading:"Initial value",sessionHeading:"Current value",keyPlaceholder:"Add new variable",valuePlaceholder:"",values:r,onChange:o,showColumns:["key","value","sessionValue"],allowedColumns:["key","value","sessionValue"],containment:{bleed:i},nonEditableKeys:!n,nonEditableValues:!n,nonEditableToggles:!n,nonEditableVariableTypes:!n,enableFiltering:!0,disableMultilineKey:!0,disableMultilineValue:!0,disallowDuplicates:!0},a))})},Ht=a().div.withConfig({displayName:"variables-table__StyledHeading",componentId:"sc-vxmldj-0"})(["display:flex;flex-direction:column;justify-content:center;box-sizing:border-box;height:var(--size-m);font-size:var(--text-size-m);color:var(--content-color-secondary);font-weight:var(--text-weight-medium);margin:var(--spacing-xs) var(--spacing-zero);padding:var(--spacing-zero) var(--spacing-l);"]),Bt=(0,y.observer)((()=>{const[e,t]=At();return(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(Ht,{children:"Variables"}),(0,w.jsx)(Ut,{values:e,onChange:t})]})})),Kt=Bt;var Jt=n(83701),Qt=n(74962),Gt=n(91214),Yt=n(80809);const Xt="collection-workbench-description-paint-time",en="collection-workbench-author-paint-time",tn="collection-workbench-description-paint-mark",nn="collection-workbench-author-paint-mark",{PerformanceMarkPaint:on}=Yt.perfComponents,rn=()=>{performance.measure(en,{},nn),(0,Yt.sendMeasureEvent)({name:en})},an=a().div.withConfig({displayName:"entity-meta-info-view__EntityMetaInfoContainer",componentId:"sc-39k1zh-0"})(["display:flex;flex-direction:column;gap:var(--spacing-l);padding-bottom:var(--spacing-xl);"]),sn=a()(Qt.Z).withConfig({displayName:"entity-meta-info-view__ItemLabel",componentId:"sc-39k1zh-1"})(["display:flex;margin-bottom:var(--spacing-xs);cursor:default;user-select:none;"]),cn=a().div.withConfig({displayName:"entity-meta-info-view__ItemContent",componentId:"sc-39k1zh-2"})(["display:flex;align-items:center;overflow:hidden;"]),ln=a()(cn).withConfig({displayName:"entity-meta-info-view__OwnerItemContent",componentId:"sc-39k1zh-3"})(["display:flex;gap:var(--spacing-s);"]),dn=e=>{const t=`/users/${e}`;return vt().ARTEMIS_URL+t};function un({info:e}){const[t,n]=(0,i.useState)(),{createdAt:o}=e||{},r=o&&new Date(o),a=r&&`${r.toLocaleDateString("en-US",{day:"2-digit",month:"short",year:"numeric"})}, ${r.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0})}`;return(0,i.useEffect)((()=>{(async()=>{if(e.owner){const t=await(0,Ve.getUserInfo)({userIds:[e.owner],type:"user"}),i=t&&t[e.owner];n(i)}})()}),[e.owner]),(0,w.jsxs)(an,{"data-testid":"entity-meta-info",children:[t&&(0,w.jsx)(on,{markName:nn,callback:rn,children:(0,w.jsxs)("div",{children:[(0,w.jsx)(sn,{type:"h6",text:"Created by",color:"content-color-secondary"}),(0,w.jsxs)(ln,{className:"entity-meta-info__item__content",children:[(0,w.jsx)(Gt.Z,{type:"user",userId:t.is_accessible?t.id:null,src:t.is_accessible?t.profile_pic_url:null,size:"m"}),(0,w.jsx)(P.Link,{to:dn(t.id),target:"_blank",children:(0,w.jsx)(_.ZP,{type:"body-medium",color:"content-color-primary",children:String(window.USER_ID)===String(t.id)?"You":t.name})})]})]})}),o&&a&&(0,w.jsxs)("div",{children:[(0,w.jsx)(sn,{type:"h6",text:"Created on",color:"content-color-secondary"}),(0,w.jsx)(cn,{className:"entity-meta-info__item__content",children:(0,w.jsx)("div",{className:"entity-meta-info__item__content__date",title:a,children:(0,w.jsx)(_.ZP,{type:"body-medium",color:"content-color-primary",children:a})})})]})]})}const pn=a()(P.Link).withConfig({displayName:"view-full-documentation-link__StyledLink",componentId:"sc-fakxit-0"})(["z-index:1;box-sizing:border-box;bottom:0;display:flex;align-self:end;align-items:center;cursor:pointer;font-size:var(--text-size-m);color:var(--content-color-link);font-weight:var(--text-weight-regular);background:var(--background-color-primary);padding:var(--spacing-s);flex-shrink:0;> i{margin-left:var(--spacing-xs);}"]),hn=a()(s.Z).withConfig({displayName:"view-full-documentation-link__StyledFlex",componentId:"sc-fakxit-1"})(["border-top:var(--border-style-solid) var(--border-width-default) var(--border-color-default);margin-right:var(--spacing-l);padding-left:var(--spacing-s);padding-bottom:var(--spacing-l);"]),mn=(e,t)=>`/workspace/${t}/documentation/${e}`;function gn({collectionId:e}){const t=(0,B.useActiveWorkspaceId)();return(0,w.jsx)(hn,{alignItems:"center",gap:"spacing-s",justifyContent:"space-between",children:(0,w.jsxs)(pn,{to:mn(e,t),customNavEvent:"VIEW_COLLECTION_FOLDER_REQUEST",children:[(0,w.jsx)("span",{children:"View complete documentation"}),(0,w.jsx)(zt.Z,{color:"content-color-link"})]})})}function vn(e){const t=(0,i.useRef)();return t.current=e,(0,i.useCallback)(((...e)=>{const n=t.current;if(!n)throw new Error("Event handler wrapped in `useEventHandler` called during render, it may only be called in effects or at any other time.");return n(...e)}),[])}var fn=n(43753);const bn=(0,i.lazy)((0,ke.loadRemoteModule)("mimir-editor/MimirEditor")),yn=o().forwardRef(((e,t)=>(0,w.jsx)(i.Suspense,{fallback:(0,w.jsx)(l.Z,{}),children:(0,w.jsx)(bn,Object.assign({},e,{ref:t}))})));var xn=n(21180);const kn="Postman editor",wn="context-view",jn=a()(Jt.Z).withConfig({displayName:"collection-description-editor__DocumentationResponsiveContainer",componentId:"sc-mzrzsv-0"})(["position:relative;font-size:var(--text-size-m);line-height:var(--line-height-m);width:100%;cursor:text;box-sizing:border-box;margin-top:",";border-radius:var(--border-radius-default);border:var(--border-width-default) var(--border-style-solid) transparent;"," &:hover{background-color:var(--background-color-secondary);background-color:",";}& .description-preview{padding:0;&__placeholder{padding:var(--spacing-m);}&__markdown{padding:var(--spacing-m);}}& .mimir{min-height:","px !important;& .editor__container{margin-top:6px;height:fit-content;& div[data-slate-editor='true']{min-height:","px !important;padding:var(--spacing-m);max-height:fit-content;width:auto;box-sizing:border-box;}}& .toolbar__anchor{height:auto;background:var(--background-color-primary);display:",";align-items:center;z-index:100;position:sticky;top:0;margin-top:-36px;background-color:transparent;border-radius:var(--border-radius-default);& .slate-HeadingToolbar{width:100%;min-height:unset;border-radius:var(--border-radius-default) var(--border-radius-default);border:var(--border-width-default) solid var(--border-color-strong);box-shadow:",";height:28px;.toolbar__wrapper{padding-right:0;}.toolbar__info{display:none;}.toolbar__list{height:fit-content;}.toolbar__dropdown{top:30px;}.toolbar__dropdown__heading{cursor:pointer;}& .toolbar__toggle{display:flex;padding-right:",";& > button{height:22px;padding:0 4px;margin-top:3px;}& .aether-dropdown__control{background:transparent;height:28px;border:none;&--is-focused{border:none;box-shadow:none;&:hover{border:none;box-shadow:none;}}}}}}","}"," ",""],(e=>e.source===wn?"34px":"0"),(e=>e.editable&&e.editMode&&(0,r.css)(["border-color:var(--base-color-info);"])),(e=>e.editable&&!e.editMode?"var(--background-color-secondary)":"transparent"),(e=>e.minimumEditorHeight),(e=>e.minimumEditorHeight),(e=>e.isInViewPort?"flex":"none"),(e=>"0px 2px 4px "+(e.theme["content-color-primary"]===fn.dark["content-color-primary"]?"rgba(0, 0, 0, 0.2)":"rgba(0, 0, 0, 0.05)")),(e=>e.source===wn?"var(--spacing-s)":"0"),(e=>!e.editMode&&(0,r.css)(["a{cursor:pointer;}.slate-codeblock-wrapper{cursor:pointer;& pre{cursor:text;}}.image-balloon-container,.image-handle.handle-right,.image-handle.handle-left,.link-balloon-container.edit,.media-balloon-container,.link-balloon-container{display:none;}.image-element.selected .image-item{opacity:1;box-shadow:unset;}"])),(e=>!e.editMode&&(0,r.css)(["[contenteditable] ~ grammarly-extension,input ~ grammarly-extension,textarea ~ grammarly-extension{display:none;}"])),(e=>e.editMode?(0,r.css)(["figure{.image-caption::placeholder{visibility:visible;}}"]):(0,r.css)(["figure{.image-caption::placeholder{visibility:hidden;}}"]))),Cn=a().div.withConfig({displayName:"collection-description-editor__SavingLoader",componentId:"sc-mzrzsv-1"})(["position:absolute;inset:0;background-color:var(--background-color-primary);opacity:0.75;z-index:1;transition:opacity 100ms ease-in-out;"]),Sn=({source:e,onSave:t,editable:n,isOffline:o,entityType:r,placeholder:a,entityDescription:s,modelDetails:c,isEntityLoading:l,resolvedEntityDescription:d,minimumEditorHeight:u=75,disableMarkdownEditor:p=!1,updateParentAboutContainerDimension:h,isBigFontSize:m=!1})=>{var g,v;const f=(0,i.useRef)(),b=(0,i.useRef)(!1),[y,x]=(0,i.useState)(!1),[k,j]=(0,i.useState)(s),[C,S]=(0,i.useState)(kn),I=kn,[_,E]=(0,i.useState)(null!=d?d:s);(0,i.useEffect)((()=>{j(s),E(d)}),[s,d]);const T=vn((()=>{n&&(S(I),x(!0))})),[L,A]=((e,t,n)=>{const o=(0,i.useRef)(null),r=(0,i.useRef)(0),a=(0,i.useRef)(),s=(0,i.useRef)(!1),c=(0,i.useRef)(!1),[l,d]=(0,i.useState)(!1),u=vn((t=>{const n=t.target,i=null!==n.closest(".slate-codeblock-wrapper")&&null==n.closest("pre"),a=void 0!==n.ownerSVGElement,c=null!==n.closest(".markdown-editor")||null!==n.closest(".toolbar__toggle")||null!==n.closest(".team-usage-error"),l=null!==n.closest(".media-element"),d=n.closest("[data-entity-id='click-to-expand-button']");if(i||a||c||d)return;l&&(t.preventDefault(),t.stopPropagation());const u=null!==n.closest("a");if(u){var p;t.preventDefault();const e=n.closest("a"),i=null==e?void 0:e.href,r=null==(p=o.current)?void 0:p.querySelector(":focus");null==r||r.blur(),i&&(0,P.openExternalLink)(i)}s.current||r.current>1||u||e()})),p=vn((t=>{if(2!==t.button){if(""===n)return e();r.current=t.detail,c.current=!0,a.current&&(clearTimeout(a.current),a.current=void 0),a.current=setTimeout((()=>{1===r.current&&u(t),r.current=0}),300)}})),h=vn((e=>{2!==e.button&&(c.current=!1)})),m=vn((()=>{s.current=!!c.current})),g=vn((t=>{const n=t.target,i=null!==(null==n?void 0:n.closest(".markdown-editor"))||null!==(null==n?void 0:n.closest(".toolbar__toggle"));(t.ctrlKey||t.metaKey)&&"c"===t.key||i||!o.current||t.target!==o.current&&!o.current.contains(t.target)||1!==t.key.length&&"Backspace"!==t.key&&"Delete"!==t.key&&"Enter"!==t.key&&"Tab"!==t.key||e()}));return(0,i.useEffect)((()=>{if(t)return;const e=o.current;return null==e||e.addEventListener("mouseup",h),null==e||e.addEventListener("mousedown",p),null==e||e.addEventListener("mousemove",m),null==e||e.addEventListener("keydown",g),()=>{null==e||e.removeEventListener("mouseup",h),null==e||e.removeEventListener("mousedown",p),null==e||e.removeEventListener("mousemove",m),null==e||e.removeEventListener("keydown",g)}}),[t]),(0,i.useEffect)((()=>{const e=new IntersectionObserver((([e])=>d(e.isIntersecting)),{threshold:0});return o.current&&e.observe(o.current),()=>{o.current&&e.unobserve(o.current)}}),[]),[o,l]})(T,y,k),N=vn((e=>{L.current&&(L.current.style.minHeight=`${e}px`,h&&h(e))})),R=vn((e=>{b.current=!!e})),Z=(0,i.useCallback)((async()=>{if(!b.current&&!o&&t&&f.current){var e,n;const i=null!=s?s:"",o=null!=(e=null==(n=f.current)?void 0:n.slateToMD())?e:"",r=i!==o;try{r&&(await t(o),K.AnalyticsService.addEventV2({category:"documentation",action:"save",label:"overview",value:1,entityType:"collection"})),x(!1)}catch(e){T()}}}),[o,s,null==f?void 0:f.current,null==b?void 0:b.current]);return(0,w.jsx)(xn.CustomErrorBoundary,{appId:"collection-workbench",errorElementId:"collection-description-editor",fallback:(0,w.jsx)(xn.GenericErrorMessage,{title:"Couldn't load documentation",description:"Just a faulty wire. Try reloading.",illustration:"illustration-internal-server-error"}),children:(0,w.jsxs)(jn,{ref:L,isInViewPort:A,type:"column",span:8,mobile:12,overflow:"unset",editMode:y,minimumEditorHeight:u,editable:n,width:null==(g=L.current)?void 0:g.offsetWidth,positionFromTop:null==(v=L.current)?void 0:v.offsetTop,className:"entity-description-container",editor:C,source:e,children:[l&&(0,w.jsx)(Cn,{}),(0,w.jsx)(yn,{ref:f,source:e,autoFocus:!1,readOnly:!n,showToolbar:y,isOffline:o,initialValue:y?k:_,modelDetails:c,onChange:Z,context:"wysiwyg",enableAutoSaveOnBlur:n,inputFormat:"markdown",onEditorHeightChange:N,updateMediaUploadStatus:R,showEditorToggle:!p&&y,isEnvironmentResolutionEnabled:!0,isBigFontSize:m,placeholder:n?null!=a?a:`Add ${r?r+" ":""}description`:`This ${r||"item"} doesn't have a description.`})]})})},In=(0,i.memo)(Sn);var _n=n(21466);const{PerformanceMarkPaint:En}=Yt.perfComponents,Pn=()=>{performance.measure(Xt,{},tn),(0,Yt.sendMeasureEvent)({name:Xt})},Tn=a()(s.Z).withConfig({displayName:"collection-overview__Container",componentId:"sc-1u4lecz-0"})(["overflow-y:auto;padding-top:var(--spacing-xxxl);padding-left:var(--spacing-l);height:100%;"]),Ln=a()(Jt.Z).withConfig({displayName:"collection-overview__ParentResponsiveContainer",componentId:"sc-1u4lecz-1"})(["width:100%;height:100%;"]),An=a()(Jt.Z).withConfig({displayName:"collection-overview__DocumentationResponsiveContainer",componentId:"sc-1u4lecz-2"})(["font-size:var(--text-size-m);line-height:var(--line-height-m);grid-template-rows:1fr auto;box-sizing:border-box;position:relative;row-gap:12px;height:100%;min-height:unset;padding-bottom:var(--spacing-zero);overflow:visible;.description-preview{overflow:auto;height:fit-content;max-height:100%;flex:1;&__markdown{word-break:break-word;}}.entity-description-container{width:100%;margin-bottom:var(--spacing-zero);& .mimir{.toolbar__anchor{top:-48px;.toolbar__wrapper{padding-right:var(--spacing-zero);}}}}"]),Nn=a()(s.Z).withConfig({displayName:"collection-overview__CollectionDescriptionEditorContainer",componentId:"sc-1u4lecz-3"})(["overflow:visible;"]),Rn=(0,y.observer)((function(){const[e]=Ke(),{canEdit:t}=ct(),{mutate:n}=at(),[o,r]=(()=>{const e=He();return[e.metadata.description,e.setDescription]})(),a=bt(),{collectionId:c}=(0,g.useParams)(),{data:l}=(0,m.useActiveVariables)(),[d,u]=(0,i.useState)(o);return(0,i.useMemo)((()=>{const e=(0,ze.v4)();_n.VSCodeCommunicationsService.postMessageToExtension({type:"RESOLVE_VARIABLES",payload:{objectToResolve:{description:JSON.parse(JSON.stringify(o))},variables:l,id:e}}),_n.VSCodeCommunicationsService.subscribe("RESOLVED_VARIABLES",(t=>{if(!t)return;const{id:n,resolvedObject:i}=t;n===e&&i&&u(i.description)}))}),[o,l]),(0,w.jsx)(Tn,{children:(0,w.jsxs)(Ln,{type:"row",maxWidth:"container-width-medium",overflow:"unset",children:[(0,w.jsx)(An,{type:"column",span:8,mobile:12,minHeight:"100%",children:(0,w.jsx)(En,{markName:tn,callback:Pn,children:(0,w.jsxs)(Nn,{direction:"column","data-testid":"collection-description-editor-container",children:[(0,w.jsx)(In,{entityId:c,onSave:e=>{r(e),n()},entityType:"collection",editable:t,entityDescription:o,resolvedEntityDescription:null!=d?d:"",source:"collection-overview",isEntityLoading:!1,minimumEditorHeight:120,isOffline:!1,modelDetails:{model:"collection",modelId:c},updateParentAboutContainerDimension:()=>{},placeholder:"Make things easier for your teammates with a complete collection description."}),c&&(0,w.jsx)(gn,{collectionId:c})]})})}),a&&(0,w.jsx)(Jt.Z,{type:"column",span:3,mobile:12,padding:{paddingRight:"spacing-s",paddingLeft:"spacing-s"},overflow:"unset",children:(0,w.jsx)(s.Z,{gap:"spacing-l",direction:"column",children:(0,w.jsx)(un,{info:{createdAt:null==a?void 0:a.createdAt,owner:e.owner}})})})]})})})),Zn=(0,i.lazy)((0,ke.loadRemoteModule)("collection-runner/CollectionRunsHistory")),zn=a()(Ye.PaneContent).withConfig({displayName:"collection-editor__StyledPaneContent",componentId:"sc-3bbfa0-0"})(["box-sizing:border-box;height:100%;width:100%;overflow:hidden;"]),Dn=a()(_t.Z).withConfig({displayName:"collection-editor__StyledTabHeaders",componentId:"sc-3bbfa0-1"})(["box-sizing:border-box;padding:var(--spacing-zero) var(--spacing-s);width:100%;"]),Vn=a()(_t.Z).withConfig({displayName:"collection-editor__StyledTabs",componentId:"sc-3bbfa0-2"})(["box-sizing:border-box;padding:var(--spacing-zero) var(--spacing-s);&,> div,> div > div{display:flex;flex-direction:column;flex:1;overflow:hidden;}"]),On=a().div.withConfig({displayName:"collection-editor__StyledDiv",componentId:"sc-3bbfa0-3"})(["width:100%;height:100%;"]),qn=()=>(0,w.jsx)(Ye.PaneHeader,{defaultLayout:"horizontal",horizontalComponent:null,width:{default:400,collapsed:33,uncollapsed:400,min:300,resizableByDefault:!0},verticalComponent:(0,w.jsx)(Ye.PaneLabel,{layout:"vertical",label:"Collection Editor",arrowDirection:"right"})}),Mn=a()(s.Z).withConfig({displayName:"collection-editor__TabHeadersWrapper",componentId:"sc-3bbfa0-4"})(["padding-inline-end:var(--spacing-l);"]),Fn=["overview","authorization","scripts","variables","runs"],Wn=()=>{const[e]=(0,P.useSearchParams)(),t=e.get("tab"),n=t&&Fn.includes(t)?Fn.indexOf(t):0,[r,a]=o().useState(n),[s,c]=(0,i.useState)(0),l=o().useRef(null);return(0,i.useEffect)((()=>{const e=()=>{l.current&&c(l.current.offsetWidth)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,w.jsxs)(On,{ref:l,children:[(0,w.jsx)($n,{switchTab:a}),(0,w.jsx)(zn,{children:(0,w.jsx)(Un,{activeTabIndex:r,containerWidth:s})})]})},$n=e=>{const[t]=(0,P.useSearchParams)(),n=t.get("tab"),i=n&&Fn.includes(n)?Fn.indexOf(n):0,[r,a]=o().useState(i);return(0,w.jsx)(Mn,{children:(0,w.jsx)(Dn,{activeTabIndex:r,onChange:function(t){a(t),e.switchTab(t)},type:"primary",incrementallyCreateTabs:!0,destroyInactiveTabs:!0,"data-testid":"collection-tab-panel",children:(0,w.jsxs)(Et.Z,{children:[(0,w.jsx)(Pt.Z,{label:"Overview"}),(0,w.jsx)(Pt.Z,{label:(0,w.jsx)(Zt,{})}),(0,w.jsx)(Pt.Z,{label:(0,w.jsx)(S,{})}),(0,w.jsx)(Pt.Z,{label:(0,w.jsx)(Nt,{})}),(0,w.jsx)(Pt.Z,{label:"Runs"})]})})})},Un=e=>(0,w.jsx)(Vn,{activeTabIndex:e.activeTabIndex,incrementallyCreateTabs:!0,destroyInactiveTabs:!0,children:(0,w.jsxs)(Tt.Z,{children:[(0,w.jsx)(Lt.Z,{children:(0,w.jsx)(Rn,{})}),(0,w.jsx)(Lt.Z,{children:(0,w.jsx)(Mt,{})}),(0,w.jsx)(Lt.Z,{children:(0,w.jsx)(Ze,{isScriptWidthNarrow:e.containerWidth<800})}),(0,w.jsx)(Lt.Z,{children:(0,w.jsx)(Kt,{})}),(0,w.jsx)(Lt.Z,{children:(0,w.jsx)(i.Suspense,{fallback:(0,w.jsx)(l.Z,{}),children:(0,w.jsx)(Zn,{})})})]})}),Hn=e=>Object.assign({},(0,Ve.collectionFindOneQuery)({collectionId:e}),{select:e=>e.data}),Bn=({children:e})=>{const t=(0,B.useActiveWorkspaceId)(),{collectionId:n}=(0,g.useParams)(),i=new m.VariablesContextStore({collectionFetchOptions:Hn(n)},{workspaceId:t});return(0,w.jsx)(m.VariablesContextProvider,{store:i,children:e})};var Kn=n(49437),Jn=n(80047);const Qn=a()(s.Z).withConfig({displayName:"coming-soon__ComingSoonWrapper",componentId:"sc-a70trz-0"})(["overflow:hidden;"]);function Gn({description:e}){return(0,w.jsx)(Qn,{direction:"column",height:"100%",justifyContent:"center",alignItems:"center",children:(0,w.jsx)(Kn.Z,{title:"Coming Soon",description:e,children:(0,w.jsx)(Jn.Z,{name:"illustration-no-custom-domain"})})})}const Yn=()=>{const{isDeleted:e,setIsDeleted:t}=(0,i.useContext)($e);return[e,t]},Xn=a()(s.Z).withConfig({displayName:"workbench-wrapper__CollectionWorkbenchContainer",componentId:"sc-x3rbex-0"})(["height:var(--wp-workbench-height);width:100vw;min-width:650px;max-width:100%;background-color:var(--background-color-primary);color:var(--content-color-primary);overflow:hidden;"]),ei=(0,y.observer)((({children:e})=>{const[t]=Yn(),{isLoading:n,error:i}=(()=>{const e=He();return{isLoading:e.isLoading,error:e.error}})(),o=(0,g.useParams)().collectionId,r=(()=>{const[,e]=Yn(),t=bt();return n=>{var i;const o=n.data;if("update_elements"===(null==(i=n.meta)?void 0:i.action))for(const n of o){const i=n.op,o=n.value,r=n.path;"remove"===i&&r.includes("/elements/collections")&&t.id===o&&e(!0)}}})();if((0,B.useWorkspaceSubscription)(o,r),(0,Ve.useCollectionSubscription)({collectionId:o||"",workspaceId:(0,B.useActiveWorkspaceId)()}),!n&&i)throw i;return t?(0,w.jsx)(xn.GenericErrorMessage,{title:"Couldn't find the collection",description:"It might have been moved or deleted.",illustration:"illustration-unable-to-load"}):(0,w.jsx)(Xn,{direction:"column",children:n?(0,w.jsx)(l.Z,{size:"large",description:"Loading Collection"}):e})})),ti=a()(s.Z).withConfig({displayName:"collection-workbench__PaneWrapper",componentId:"sc-1i28mc1-0"})(["overflow:hidden;flex:1;min-width:650px;max-width:100%;"]),ni=()=>{const e=(0,w.jsx)(Ue,{children:(0,w.jsx)(Bn,{children:(0,w.jsx)(c.VW,{children:(0,w.jsx)(Ye.Toast.Ui.ToastEventEmitter,{children:(0,w.jsxs)(ei,{children:[(0,w.jsx)(It,{}),(0,w.jsxs)(ti,{direction:"column",children:[(0,w.jsx)(qn,{}),(0,w.jsx)(Wn,{})]})]})})})})});return Ve.ENABLE_COLLECTIONS?e:(0,w.jsx)(Gn,{description:"Collections coming soon"})}}}]);
//# sourceMappingURL=7520.87702a6eaeaf3b6a.js.map